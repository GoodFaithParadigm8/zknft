(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"/yFf":function(t,e,r){"use strict";var n=r("oHnp");function s(t){if(t)return function(t){for(var e in s.prototype)t[e]=s.prototype[e];return t}(t)}t.exports=s,s.prototype.get=function(t){return this.header[t.toLowerCase()]},s.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=n.type(e);var r=n.params(e);for(var s in r)this[s]=r[s];this.links={};try{t.link&&(this.links=n.parseLinks(t.link))}catch(i){}},s.prototype._setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.redirect=3==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.created=201==t,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.forbidden=403==t,this.notFound=404==t,this.unprocessableEntity=422==t}},"1B/i":function(t,e,r){"use strict";r.r(e),r.d(e,"TypedDataUtils",(function(){return i})),r.d(e,"buildTypedData",(function(){return o})),r.d(e,"domainType",(function(){return u})),r.d(e,"encodeTypedDataDigest",(function(){return a}));var n=r("wDBh"),s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var s in e=arguments[r])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)},i={encodeDigest:function(t){var e=n.ethers.utils.arrayify("0x1901"),r=i.hashStruct(t,"EIP712Domain",t.domain),s=i.hashStruct(t,t.primaryType,t.message),a=n.ethers.utils.solidityPack(["bytes","bytes32","bytes32"],[e,h(r,32),h(s,32)]),o=n.ethers.utils.keccak256(a);return n.ethers.utils.arrayify(o)},encodeData:function(t,e,r){var s=t.types,a=s[e];if(!a||0===a.length)throw new Error("TypedDataUtils: "+t.primaryType+" type is not unknown");var o=new n.ethers.utils.AbiCoder,u=[],c=[],l=i.typeHash(t.types,e);u.push("bytes32"),c.push(h(l,32));for(var p=function(e,r,a){if(void 0!==s[r])return["bytes32",n.ethers.utils.arrayify(n.ethers.utils.keccak256(i.encodeData(t,r,a)))];if("bytes"===r||"string"===r){var u=void 0;return u="string"===r?n.ethers.utils.toUtf8Bytes(a):n.ethers.utils.arrayify(a),["bytes32",n.ethers.utils.arrayify(n.ethers.utils.hexZeroPad(n.ethers.utils.keccak256(u),32))]}if(r.lastIndexOf("[")>0){var h=r.slice(0,r.lastIndexOf("["));return u=a.map((function(t){return p(e,h,t)})),["bytes32",n.ethers.utils.arrayify(n.ethers.utils.keccak256(n.ethers.utils.arrayify(o.encode(u.map((function(t){return t[0]})),u.map((function(t){return t[1]}))))))]}return[r,a]},f=0,d=a;f<d.length;f++){var g=d[f],y=p(g.name,g.type,r[g.name]),_=y[1];u.push(y[0]),c.push(_)}return n.ethers.utils.arrayify(o.encode(u,c))},hashStruct:function(t,e,r){return n.ethers.utils.arrayify(n.ethers.utils.keccak256(i.encodeData(t,e,r)))},typeHash:function(t,e){return n.ethers.utils.arrayify(n.ethers.utils.keccak256(n.ethers.utils.toUtf8Bytes(i.encodeType(t,e))))},encodeType:function(t,e){var r=t[e];if(!r||0===r.length)throw new Error("TypedDataUtils: "+e+" type is not defined");for(var n=[],s=e+"(",a=0;a<r.length;a++){var o=r[a],u=o.type.indexOf("["),h=u<0?o.type:o.type.slice(0,u);if(t[h]&&t[h].length>0){for(var c=!1,l=0;l<n.length;l++)n[l]===h&&(c=!0);c||n.push(h)}s+=o.type+" "+o.name,a<r.length-1&&(s+=",")}for(s+=")",n.sort(),a=0;a<n.length;a++)s+=i.encodeType(t,n[a]);return s},domainType:function(t){var e=[];return t.name&&e.push({name:"name",type:"string"}),t.version&&e.push({name:"version",type:"string"}),t.chainId&&e.push({name:"chainId",type:"uint256"}),t.verifyingContract&&e.push({name:"verifyingContract",type:"address"}),t.salt&&e.push({name:"salt",type:"bytes32"}),e},buildTypedData:function(t,e,r,n){var a=i.domainType(t);return{domain:t,types:s({EIP712Domain:a},e),primaryType:r,message:n}}},a=function(t){return i.encodeDigest(t)},o=function(t,e,r,n){return i.buildTypedData(t,e,r,n)},u=function(t){return i.domainType(t)},h=function(t,e){return n.ethers.utils.arrayify(n.ethers.utils.hexZeroPad(n.ethers.utils.hexlify(t),e))}},"24Ii":function(t,e,r){var n;"undefined"!=typeof window?n=window:"undefined"!=typeof self?n=self:(console.warn("Using browser-only version of superagent in non-browser environment"),n=this);var s=r("cpc2"),i=r("kMlx"),a=r("8zgK"),o=r("/yFf"),u=r("nZbv");function h(){}var c=e=t.exports=function(t,r){return"function"==typeof r?new e.Request("GET",t).end(r):1==arguments.length?new e.Request("GET",t):new e.Request(t,r)};e.Request=_,c.getXHR=function(){if(!(!n.XMLHttpRequest||n.location&&"file:"==n.location.protocol&&n.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw Error("Browser-only version of superagent could not find XHR")};var l="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function p(t){if(!a(t))return t;var e=[];for(var r in t)f(e,r,t[r]);return e.join("&")}function f(t,e,r){if(null!=r)if(Array.isArray(r))r.forEach((function(r){f(t,e,r)}));else if(a(r))for(var n in r)f(t,e+"["+n+"]",r[n]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));else null===r&&t.push(encodeURIComponent(e))}function d(t){for(var e,r,n={},s=t.split("&"),i=0,a=s.length;i<a;++i)-1==(r=(e=s[i]).indexOf("="))?n[decodeURIComponent(e)]="":n[decodeURIComponent(e.slice(0,r))]=decodeURIComponent(e.slice(r+1));return n}function g(t){return/[\/+]json($|[^-\w])/.test(t)}function y(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.header=this.headers=function(t){for(var e,r,n,s,i=t.split(/\r?\n/),a={},o=0,u=i.length;o<u;++o)-1!==(e=(r=i[o]).indexOf(":"))&&(n=r.slice(0,e).toLowerCase(),s=l(r.slice(e+1)),a[n]=s);return a}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body=null===this.text&&t._responseType?this.xhr.response:"HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function _(t,e){var r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",(function(){var t,e=null,n=null;try{n=new y(r)}catch(s){return(e=new Error("Parser is unable to parse the response")).parse=!0,e.original=s,r.xhr?(e.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,e.status=r.xhr.status?r.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),r.callback(e)}r.emit("response",n);try{r._isResponseOK(n)||(t=new Error(n.statusText||"Unsuccessful HTTP response"))}catch(i){t=i}t?(t.original=e,t.response=n,t.status=n.status,r.callback(t,n)):r.callback(null,n)}))}function E(t,e,r){var n=c("DELETE",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}c.serializeObject=p,c.parseString=d,c.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},c.serialize={"application/x-www-form-urlencoded":p,"application/json":JSON.stringify},c.parse={"application/x-www-form-urlencoded":d,"application/json":JSON.parse},o(y.prototype),y.prototype._parseBody=function(t){var e=c.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&g(this.type)&&(e=c.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null)},y.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n=new Error("cannot "+e+" "+r+" ("+this.status+")");return n.status=this.status,n.method=e,n.url=r,n},c.Response=y,s(_.prototype),i(_.prototype),_.prototype.type=function(t){return this.set("Content-Type",c.types[t]||t),this},_.prototype.accept=function(t){return this.set("Accept",c.types[t]||t),this},_.prototype.auth=function(t,e,r){1===arguments.length&&(e=""),"object"==typeof e&&null!==e&&(r=e,e=""),r||(r={type:"function"==typeof btoa?"basic":"auto"});var n=function(t){if("function"==typeof btoa)return btoa(t);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(t,e,r,n)},_.prototype.query=function(t){return"string"!=typeof t&&(t=p(t)),t&&this._query.push(t),this},_.prototype.attach=function(t,e,r){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,r||e.name)}return this},_.prototype._getFormData=function(){return this._formData||(this._formData=new n.FormData),this._formData},_.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var r=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),r(t,e)},_.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},_.prototype.buffer=_.prototype.ca=_.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},_.prototype.pipe=_.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},_.prototype._isHost=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},_.prototype.end=function(t){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||h,this._finalizeQueryString(),this._end()},_.prototype._end=function(){var t=this,e=this.xhr=c.getXHR(),r=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var r=e.readyState;if(r>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4==r){var n;try{n=e.status}catch(s){n=0}if(!n){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var n=function(e,r){r.total>0&&(r.percent=r.loaded/r.total*100),r.direction=e,t.emit("progress",r)};if(this.hasListeners("progress"))try{e.onprogress=n.bind(null,"download"),e.upload&&(e.upload.onprogress=n.bind(null,"upload"))}catch(o){}try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(u){return this.callback(u)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof r&&!this._isHost(r)){var s=this._header["content-type"],i=this._serializer||c.serialize[s?s.split(";")[0]:""];!i&&g(s)&&(i=c.serialize["application/json"]),i&&(r=i(r))}for(var a in this.header)null!=this.header[a]&&this.header.hasOwnProperty(a)&&e.setRequestHeader(a,this.header[a]);return this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0!==r?r:null),this},c.agent=function(){return new u},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach((function(t){u.prototype[t.toLowerCase()]=function(e,r){var n=new c.Request(t,e);return this._setDefaults(n),r&&n.end(r),n}})),u.prototype.del=u.prototype.delete,c.get=function(t,e,r){var n=c("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},c.head=function(t,e,r){var n=c("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},c.options=function(t,e,r){var n=c("OPTIONS",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},c.del=E,c.delete=E,c.patch=function(t,e,r){var n=c("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},c.post=function(t,e,r){var n=c("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},c.put=function(t,e,r){var n=c("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}},"2k3W":function(t,e,r){"use strict";r.r(e),r.d(e,"bits",(function(){return s})),r.d(e,"buffer",(function(){return E})),r.d(e,"byte",(function(){return m})),r.d(e,"integer",(function(){return w})),r.d(e,"nibble",(function(){return S})),r.d(e,"string",(function(){return b}));for(var n=function(t){for(var e=[],r=0;r<t.length;r++)e[r]=1^t[r];return e},s={and:function(t,e){for(var r=[],n=0;n<t.length;n++)r[n]=t[n]&e[n];return r},circularShiftLeft:function(t,e){var r=[];if(e>t.length)throw new Error("shift amount can\u2019t be larger than bits array length");for(var n=0;n<t.length;n++)r[(t.length+n-e)%t.length]=t[n];return r},circularShiftRight:function(t,e){var r=[];if(e>t.length)throw new Error("shift amount can\u2019t be larger than bits array length");for(var n=0;n<t.length;n++)r[(n+e)%t.length]=t[n];return r},nand:function(t,e){for(var r=[],n=0;n<t.length;n++)r[n]=t[n]&e[n]^1;return r},nor:function(t,e){for(var r=[],n=0;n<t.length;n++)r[n]=1^(t[n]|e[n]);return r},not:n,or:function(t,e){for(var r=[],n=0;n<t.length;n++)r[n]=t[n]|e[n];return r},reduceAnd:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],r=1;r<t.length;r++)e&=t[r];return e},reduceNand:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],r=1;r<t.length;r++)e=e&t[r]^1;return e},reduceNor:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],r=1;r<t.length;r++)e=1^(e|t[r]);return e},reduceOr:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],r=1;r<t.length;r++)e|=t[r];return e},reduceXnor:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],r=1;r<t.length;r++)e^=1^t[r];return e},reduceXor:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],r=1;r<t.length;r++)e^=t[r];return e},toBoolean:function(t){for(var e=[],r=0;r<t.length;r++)e[r]=1===t[r];return e},toString:function(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=" "),!e)return t.join("");for(var n="",s=0;s<t.length;s++)n+=""+t[s],s%e==e-1&&s!==t.length-1&&(n+=r);return n},xnor:function(t,e){for(var r=[],n=0;n<t.length;n++)r[n]=t[n]^e[n]^1;return r},xor:function(t,e){for(var r=[],n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}},i=r("XUzR"),a=r("GCxg"),o=r("G1u+"),u=function(t){if(t>255||t<0||~~t!==t)throw new RangeError("invalid byte");for(var e=[0,0,0,0,0,0,0,0],r=0;r<8;r++)e[7-r]=t>>r&1;return e},h=function(t,e,r){void 0===e&&(e=0),r||(r=8*t.length-e);var n=Math.floor(e/8),s=Math.floor(r/8)+2,i=[];i.length=8*s;for(var a=0;a<s;a++)if(void 0!==t[n+a]){var o=u(t[n+a]);i[8*a]=o[0],i[8*a+1]=o[1],i[8*a+2]=o[2],i[8*a+3]=o[3],i[8*a+4]=o[4],i[8*a+5]=o[5],i[8*a+6]=o[6],i[8*a+7]=o[7]}var h=e%8;return i.slice(h,h+r)},c=r("nMdu"),l=r("ILq/"),p=r("f7RY"),f=r("YnKP"),d=[],g=0;g<32;g++)d[g]=Math.pow(2,g);var y=r("vGFC"),_=r("5tNv"),E={and:i.a,create:a.a,modify:function(t,e,r){void 0===r&&(r=0);for(var n=Math.floor(r/8),s=Math.ceil((r+e.length)/8),i=t.slice(n,s),a=h(i),u=r%8,c=0;c<e.length;c++)a[u++]=e[c];for(var l=s-n,p=0;p<l;p++)i[p]=Object(o.a)(a.slice(8*p,8*(p+1)))},nand:c.a,nor:l.a,not:p.a,or:f.a,read:h,readInt:function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=8);var s=h(t,e,r);if(0===s[0]){for(var i=0,a=0;a<r;a++)s[a]&&(i+=d[r-a-1]);return i}i=-1;var o=n(s);for(a=0;a<r;a++)o[a]&&(i-=d[r-a-1]);return i},readUInt:function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=8);for(var n=h(t,e,r),s=0,i=0;i<r;i++)s+=n[i]*d[r-i-1];return s},xnor:y.a,xor:_.a},m={read:u,write:o.a},w={getBit:function(t,e){return t>>e&1},setBit:function(t,e,r){return 1===r?t|1<<e:t&~(1<<e)},toggleBit:function(t,e){return t^1<<e}},S={read:function(t){if(t<16&&t>=0&&Math.floor(t)===t){for(var e=[0,0,0,0],r=0;r<4;r++)e[3-r]=t>>r&1;return e}throw new RangeError("invalid array length")},write:function(t){if(!Array.isArray(t)||4!==t.length)throw new RangeError("invalid array length");for(var e=0,r=0;r<4;r++)t[3-r]&&(e|=1<<r);return e}},b={toBits:function(t){for(var e=[],r=0;r<t.length;r++)"1"===t[r]?e.push(1):"0"===t[r]&&e.push(0);return e}};e.default={bits:s,buffer:E,byte:m,integer:w,nibble:S,string:b}},"4Mn8":function(t,e,r){const n=r("pzNo");t.exports={Client:n}},"5tNv":function(t,e,r){"use strict";(function(t){e.a=function(e,r,n){void 0===n&&(n=!1);for(var s=n?r.length:e.length,i=t.alloc(s),a=0;a<s;a++)i[a]=e[n?a%e.length:a]^r[a];return i}}).call(this,r("tjlA").Buffer)},"6WMX":function(t,e,r){const n=r("B3Rj"),s=r("b3gk"),i=r("tjlA").Buffer,a=r("L21C"),o=i.from("01","hex"),{HARDENED_OFFSET:u}=r("L21C"),h=[44+u,u,u,1,0],c={LEGACY:0,SEGWIT:5,TESTNET:111,SEGWIT_TESTNET:196};e.addressVersion=c;const l={P2PKH:1,P2SH:2,P2SH_P2WPKH:3};function p(t,e){return i.concat([t,e])}function f(t){const e=i.alloc(4);return e.writeUInt32LE(t),e}function d(t){let e;return t<253?(e=i.alloc(1),e.writeUInt8(t)):t<=65535?(e=i.alloc(3),e.writeUInt8(253,0),e.writeUInt16LE(t,1)):t<4294967295?(e=i.alloc(5),e.writeUInt8(254,0),e.writeUInt32LE(t,1)):(e=i.alloc(9),e.writeUInt8(255,0),e.writeUInt32LE(t>>>0,1),e.writeUInt32LE(t/4294967296|0,5)),e}function g(t,e,r){"number"==typeof t&&(t=t.toString(16));const n=i.alloc(8),s=t.length%2==0?t.toString(16):"0"+t.toString(16);return i.from(s,"hex").reverse().copy(n,0),n.copy(e,r),n}e.scriptTypes=l,e.buildBitcoinTxRequest=function(t){try{const{prevOuts:e,recipient:r,value:o,changePath:u=h,fee:p,isSegwit:f,changeVersion:d="SEGWIT"}=t;if(5!==u.length)throw new Error("Please provide a full change path.");const y=i.alloc(59+69*e.length);let _=0;if(void 0===c[d])throw new Error("Invalid change version specified.");y.writeUInt8(c[d]),_++,y.writeUInt32LE(u.length,_),_+=4;for(let t=0;t<u.length;t++)y.writeUInt32LE(u[t],_),_+=4;y.writeUInt32LE(p,_),_+=4;const E=n.decode(r)[0],m=s.decode(r).slice(1);y.writeUInt8(E,_),_++,m.copy(y,_),_+=m.length,g(o,y,_),_+=8,y.writeUInt8(e.length,_),_++;let w=0;const S=!0===f?l.P2SH_P2WPKH:l.P2PKH;return e.forEach(t=>{if(!t.signerPath||5!==t.signerPath.length)throw new Error("Full recipient path not specified ");y.writeUInt32LE(t.signerPath.length,_),_+=4;for(let e=0;e<t.signerPath.length;e++)y.writeUInt32LE(t.signerPath[e],_),_+=4;y.writeUInt32LE(t.index,_),_+=4,g(t.value,y,_),_+=8,w+=t.value,y.writeUInt8(S,_),_++,i.isBuffer(t.txHash)||(t.txHash=i.from(t.txHash,"hex")),t.txHash.copy(y,_),_+=t.txHash.length}),{payload:y,schema:a.signingSchema.BTC_TRANSFER,origData:t,changeData:{changeVersion:d,value:w-(o+p)}}}catch(e){return{err:e}}},e.serializeTx=function(t){const{inputs:e,outputs:r,isSegwitSpend:a,lockTime:u=0,crypto:h}=t;let l=i.alloc(4),y=0;l.writeUInt32LE(2,y),y+=4,!0===a&&(l=p(l,i.from("00","hex")),l=p(l,i.from("01","hex")));const _=d(e.length);l=p(l,_),y+=_.length,e.forEach(t=>{l=p(l,t.hash.reverse()),y+=t.hash.length;const e=f(t.index);if(l=p(l,e),y+=e.length,!0===a){const e=function(t,e){const r=i.alloc(22),n=e.createHash("sha256").update(t).digest(),s=e.createHash("rmd160").update(n).digest();return r.writeUInt8(0),r.writeUInt8(s.length,1),s.copy(r,2),r}(t.pubkey,h),r=d(e.length),n=i.concat([r,e]),s=d(n.length);l=p(l,s),y+=s.length,l=p(l,n),y+=n.length}else{const e=function(t,e){const r=d((t=i.concat([t,o])).length),n=d(e.length),s=i.concat([r,t,n,e]),a=d(s.length);return i.concat([a,s])}(t.sig,t.pubkey);l=p(l,e),y+=e.length}const r=f(4294967295);l=p(l,r),y+=r.length});const E=d(r.length);if(l=p(l,E),y+=E.length,r.forEach(t=>{const e=function(t){const e=i.alloc(8);return g(t,e,0),e}(t.value);l=p(l,e),y+=e.length;const r=function(t){const e=n.decode(t)[0],r=s.decode(t).slice(1);return e===c.SEGWIT||e===c.SEGWIT_TESTNET?function(t){const e=i.alloc(3+t.length);let r=0;return e.writeUInt8(169,r),r++,e.writeUInt8(t.length,r),r++,t.copy(e,r),r+=t.length,e.writeUInt8(135,r),r++,e}(r):function(t){const e=i.alloc(5+t.length);let r=0;return e.writeUInt8(118,r),r++,e.writeUInt8(169,r),r++,e.writeUInt8(t.length,r),r++,t.copy(e,r),r+=t.length,e.writeUInt8(136,r),r++,e.writeUInt8(172,r),r++,e}(r)}(t.recipient),a=d(r.length);l=p(l,a),y+=a.length,l=p(l,r),y+=r.length}),!0===a){const t=[],r=[];for(let s=0;s<e.length;s++)t.push(e[s].sig),r.push(e[s].pubkey);const n=function(t,e){let r=i.alloc(0);const n=i.alloc(1);n.writeUInt8(2);for(let s=0;s<t.length;s++){const a=i.concat([t[s],o]),u=d(a.length),h=e[s],c=d(h.length);r=i.concat([r,n,u,a,c,h])}return r}(t,r);l=p(l,n),y+=n.length}return i.concat([l,f(u)]).toString("hex")},e.getBitcoinAddress=function(t,e){return s.encode(i.concat([i.from([e]),t]))}},"8zgK":function(t,e,r){"use strict";t.exports=function(t){return null!==t&&"object"==typeof t}},AREZ:function(t,e,r){"use strict";e.Diagnose=r("jpl7"),e.Decoder=r("hDHj"),e.Encoder=r("LcfU"),e.Simple=r("UHYx"),e.Tagged=r("IrRL"),e.decodeAll=e.Decoder.decodeAll,e.decodeFirst=e.Decoder.decodeFirst,e.diagnose=e.Diagnose.diagnose,e.encode=e.Encoder.encode,e.decode=e.Decoder.decode,e.leveldb={decode:e.Decoder.decodeAll,encode:e.Encoder.encode,buffer:!0,name:"cbor"}},Fq86:function(t,e,r){"use strict";const{URLWithLegacySupport:n,format:s,URLSearchParams:i,defaultBase:a}=r("HwtC"),o=r("PV6L");t.exports={URL:n,URLSearchParams:i,format:s,relative:o,defaultBase:a}},"G1u+":function(t,e,r){"use strict";e.a=function(t){if(!Array.isArray(t)||8!==t.length)throw new RangeError("invalid array length");for(var e=0,r=0;r<8;r++)t[7-r]&&(e|=1<<r);return e}},GCxg:function(t,e,r){"use strict";(function(t){var n=r("G1u+");e.a=function(e){for(var r=[0,0,0,0,0,0,0,0],s=t.alloc(Math.ceil(e.length/8)),i=0;i<s.length;i++){for(var a=0;a<8;a++)r[a]=e[8*i+a]?e[8*i+a]:0;s[i]=Object(n.a)(r)}return s}}).call(this,r("tjlA").Buffer)},HwtC:function(t,e,r){"use strict";const n=self.location?self.location.protocol+"//"+self.location.host:"",s=self.URL;t.exports={URLWithLegacySupport:class{constructor(t="",e=n){this.super=new s(t,e),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(t){this.super.hash=t}set host(t){this.super.host=t}set hostname(t){this.super.hostname=t}set href(t){this.super.href=t}set origin(t){this.super.origin=t}set password(t){this.super.password=t}set pathname(t){this.super.pathname=t}set port(t){this.super.port=t}set protocol(t){this.super.protocol=t}set search(t){this.super.search=t}set searchParams(t){this.super.searchParams=t}set username(t){this.super.username=t}createObjectURL(t){return this.super.createObjectURL(t)}revokeObjectURL(t){this.super.revokeObjectURL(t)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:n,format:function(t){if("string"==typeof t)return new s(t).toString();if(!(t instanceof s)){const e=t.auth?t.auth+"@":"",r=t.port?":"+t.port:"",n=t.hostname||"",s=t.search||(t.query?"?"+t.query:""),i=t.pathname||"";return`${t.protocol?t.protocol+"//":""}${(t.username&&t.password?`${t.username}:${t.password}@`:"")||e}${t.host||n+r}${t.path||i+s}${t.hash||""}`}}}},"ILq/":function(t,e,r){"use strict";(function(t){e.a=function(e,r,n){void 0===n&&(n=!1);for(var s=n?r.length:e.length,i=t.alloc(s),a=0;a<s;a++)i[a]=~(e[n?a%e.length:a]|r[a]);return i}}).call(this,r("tjlA").Buffer)},IrRL:function(t,e,r){"use strict";class n{constructor(t,e,r){if(this.tag=t,this.value=e,this.err=r,"number"!=typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(t){return t._pushTag(this.tag),t.pushAny(this.value)}convert(t){var e;if("function"!=typeof(e=null!=t?t[this.tag]:void 0)&&"function"!=typeof(e=n["_tag"+this.tag]))return this;try{return e.call(n,this.value)}catch(r){return this.err=r,this}}}t.exports=n},L21C:function(t,e){const r={finalizePair:0,getAddresses:1290,sign:1090,getWallets:142,addAbiDefs:8,test:1646};let n=0;Object.keys(r).forEach(t=>{r[t]+82>n&&(n=r[t]+82)});const s={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WALLET_NOT_PRESENT:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141};t.exports={getFwVersionConst:function(t){const e={extraDataFrameSz:0,extraDataMaxFrames:0};function r(t,e){return t[2]>e[0]||t[2]===e[0]&&t[1]>e[1]||t[2]===e[0]&&t[1]===e[1]&&t[0]>e[2]||t[2]===e[0]&&t[1]===e[1]&&t[0]===e[2]}const n=0===t.length;return!n&&r(t,[0,10,5])&&(e.varAddrPathSzAllowed=!0,e.eip712Supported=!0),!n&&r(t,[0,10,4])&&(e.extraDataFrameSz=1500,e.extraDataMaxFrames=1),!n&&r(t,[0,10,4])||!n&&r(t,[0,10,0])?(e.reqMaxDataSz=1678,e.ethMaxDataSz=e.reqMaxDataSz-128,e.ethMaxMsgSz=e.ethMaxDataSz,e.ethMaxGasPrice=2e13,e.addrFlagsAllowed=!0):(e.reqMaxDataSz=1152,e.ethMaxDataSz=e.reqMaxDataSz-128,e.ethMaxMsgSz=e.ethMaxDataSz,e.ethMaxGasPrice=5e11,e.addrFlagsAllowed=!1),e},ADDR_STR_LEN:129,AES_IV:[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100],BASE_URL:"https://signing.gridpl.us",ENC_MSG_LEN:n,addressSizes:{BTC:20,ETH:20},decResLengths:r,deviceCodes:{CONNECT:1,ENCRYPTED_REQUEST:2},encReqCodes:{FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_ABI_DEFS:6,TEST:7},ethMsgProtocol:{SIGN_PERSONAL:{str:"signPersonal",enumIdx:0},TYPED_DATA:{str:"typedData",enumIdx:1,rawDataMaxLen:1629,typeCodes:{bytes1:1,bytes2:2,bytes3:3,bytes4:4,bytes5:5,bytes6:6,bytes7:7,bytes8:8,bytes9:9,bytes10:10,bytes11:11,bytes12:12,bytes13:13,bytes14:14,bytes15:15,bytes16:16,bytes17:17,bytes18:18,bytes19:19,bytes20:20,bytes21:21,bytes22:22,bytes23:23,bytes24:24,bytes25:25,bytes26:27,bytes27:28,bytes28:29,bytes29:30,bytes30:31,bytes31:32,bytes32:33,uint8:34,uint16:35,uint32:36,uint64:37,uint256:38,bool:44,address:45,bytes:47,string:48}}},messageConstants:{NOT_PAIRED:0,PAIRED:1},responseCodes:s,responseMsgs:{[s.RESP_SUCCESS]:0,[s.RESP_ERR_INVALID_MSG]:"Invalid Request",[s.RESP_ERR_UNSUPPORTED_VER]:"Unsupported Version",[s.RESP_ERR_DEV_BUSY]:"Device Busy",[s.RESP_ERR_USER_TIMEOUT]:"Timeout Waiting for User",[s.RESP_ERR_USER_DECLINED]:"Request Declined by User",[s.RESP_ERR_PAIR_FAIL]:"Pairing Failed",[s.RESP_ERR_PAIR_DISABLED]:"Pairing is Currently Disabled",[s.RESP_ERR_PERMISSION_DISABLED]:"Automated Signing is Currently Disabled",[s.RESP_ERR_INTERNAL]:"Device Error",[s.RESP_ERR_GCE_TIMEOUT]:"Timeout",[s.RESP_ERR_WALLET_NOT_PRESENT]:"Incorrect Wallet UID Provided",[s.RESP_ERR_DEV_LOCKED]:"Device Locked",[s.RESP_ERR_DISABLED]:"Disabled",[s.RESP_ERR_ALREADY]:"Record already exists. You must first remove it on your device."},signingSchema:{BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3,EXTRA_DATA:4},REQUEST_TYPE_BYTE:2,VERSION_BYTE:1,HARDENED_OFFSET:2147483648,HANDLE_LARGER_CHAIN_ID:255,MAX_CHAIN_ID_BYTES:8,ETH_ABI_LATTICE_FW_TYPE_MAP:{address:1,bool:2,uint8:3,uint16:4,uint32:5,uint64:6,uint128:7,uint256:8,uint:15,bytes1:17,bytes2:18,bytes3:19,bytes4:20,bytes5:21,bytes6:22,bytes7:23,bytes8:24,bytes9:25,bytes10:26,bytes11:27,bytes12:28,bytes13:29,bytes14:30,bytes15:31,bytes16:32,bytes17:33,bytes18:34,bytes19:35,bytes20:36,bytes21:37,bytes22:38,bytes23:39,bytes24:40,bytes25:41,bytes26:42,bytes27:43,bytes28:44,bytes29:45,bytes30:46,bytes31:47,bytes32:48,bytes:49,string:50,tuple1:51,tuple2:52,tuple3:53,tuple4:54,tuple5:55,tuple6:56,tuple7:57,tuple8:58,tuple9:59,tuple10:60,tuple11:61,tuple12:62,tuple13:63,tuple14:64,tuple15:65,tuple16:66,tuple17:67}}},LcfU:function(t,e,r){"use strict";const{Buffer:n}=r("tjlA"),{URL:s}=r("Fq86"),i=r("kB5k").BigNumber,a=r("XuWj"),o=r("hb4V"),u=o.MT,h=o.NUMBYTES,c=o.SHIFT32,l=o.SYMS,p=o.TAG,f=o.MT.SIMPLE_FLOAT<<5|o.NUMBYTES.TWO,d=o.MT.SIMPLE_FLOAT<<5|o.NUMBYTES.FOUR,g=o.MT.SIMPLE_FLOAT<<5|o.NUMBYTES.EIGHT,y=o.MT.SIMPLE_FLOAT<<5|o.SIMPLE.TRUE,_=o.MT.SIMPLE_FLOAT<<5|o.SIMPLE.FALSE,E=o.MT.SIMPLE_FLOAT<<5|o.SIMPLE.UNDEFINED,m=o.MT.SIMPLE_FLOAT<<5|o.SIMPLE.NULL,w=new i("0x20000000000000"),S=n.from("f97e00","hex"),b=n.from("f9fc00","hex"),v=n.from("f97c00","hex");class I{constructor(t){this.streaming="function"==typeof(t=t||{}).stream,this.onData=t.stream,this.semanticTypes=[[s,this._pushUrl],[i,this._pushBigNumber]];const e=t.genTypes||[],r=e.length;for(let n=0;n<r;n++)this.addSemanticType(e[n][0],e[n][1]);this._reset()}addSemanticType(t,e){const r=this.semanticTypes.length;for(let n=0;n<r;n++)if(this.semanticTypes[n][0]===t){const t=this.semanticTypes[n][1];return this.semanticTypes[n][1]=e,t}return this.semanticTypes.push([t,e]),null}push(t){return!t||(this.result[this.offset]=t,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=t.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(t,e,r){return this.result[this.offset]=t,this.resultMethod[this.offset]=e,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(t){return this.pushWrite(t,1,1)}_pushUInt16BE(t){return this.pushWrite(t,2,2)}_pushUInt32BE(t){return this.pushWrite(t,3,4)}_pushDoubleBE(t){return this.pushWrite(t,4,8)}_pushNaN(){return this.push(S)}_pushInfinity(t){return this.push(t<0?b:v)}_pushFloat(t){const e=n.allocUnsafe(2);if(a.writeHalf(e,t)&&a.parseHalf(e)===t)return this._pushUInt8(f)&&this.push(e);const r=n.allocUnsafe(4);return r.writeFloatBE(t,0),r.readFloatBE(0)===t?this._pushUInt8(d)&&this.push(r):this._pushUInt8(g)&&this._pushDoubleBE(t)}_pushInt(t,e,r){const n=e<<5;return t<24?this._pushUInt8(n|t):t<=255?this._pushUInt8(n|h.ONE)&&this._pushUInt8(t):t<=65535?this._pushUInt8(n|h.TWO)&&this._pushUInt16BE(t):t<=4294967295?this._pushUInt8(n|h.FOUR)&&this._pushUInt32BE(t):t<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|h.EIGHT)&&this._pushUInt32BE(Math.floor(t/c))&&this._pushUInt32BE(t%c):this._pushFloat(e===u.NEG_INT?r:t)}_pushIntNum(t){return t<0?this._pushInt(-t-1,u.NEG_INT,t):this._pushInt(t,u.POS_INT)}_pushNumber(t){switch(!1){case t==t:return this._pushNaN(t);case isFinite(t):return this._pushInfinity(t);case t%1!=0:return this._pushIntNum(t);default:return this._pushFloat(t)}}_pushString(t){const e=n.byteLength(t,"utf8");return this._pushInt(e,u.UTF8_STRING)&&this.pushWrite(t,5,e)}_pushBoolean(t){return this._pushUInt8(t?y:_)}_pushUndefined(t){return this._pushUInt8(E)}_pushArray(t,e){const r=e.length;if(!t._pushInt(r,u.ARRAY))return!1;for(let n=0;n<r;n++)if(!t.pushAny(e[n]))return!1;return!0}_pushTag(t){return this._pushInt(t,u.TAG)}_pushDate(t,e){return t._pushTag(p.DATE_EPOCH)&&t.pushAny(Math.round(e/1e3))}_pushBuffer(t,e){return t._pushInt(e.length,u.BYTE_STRING)&&t.push(e)}_pushNoFilter(t,e){return t._pushBuffer(t,e.slice())}_pushRegexp(t,e){return t._pushTag(p.REGEXP)&&t.pushAny(e.source)}_pushSet(t,e){if(!t._pushInt(e.size,u.ARRAY))return!1;for(const r of e)if(!t.pushAny(r))return!1;return!0}_pushUrl(t,e){return t._pushTag(p.URI)&&t.pushAny(e.format())}_pushBigint(t){let e=p.POS_BIGINT;t.isNegative()&&(t=t.negated().minus(1),e=p.NEG_BIGINT);let r=t.toString(16);r.length%2&&(r="0"+r);const s=n.from(r,"hex");return this._pushTag(e)&&this._pushBuffer(this,s)}_pushBigNumber(t,e){if(e.isNaN())return t._pushNaN();if(!e.isFinite())return t._pushInfinity(e.isNegative()?-1/0:1/0);if(e.isInteger())return t._pushBigint(e);if(!t._pushTag(p.DECIMAL_FRAC)||!t._pushInt(2,u.ARRAY))return!1;const r=e.decimalPlaces(),n=e.multipliedBy(new i(10).pow(r));return!!t._pushIntNum(-r)&&(n.abs().isLessThan(w)?t._pushIntNum(n.toNumber()):t._pushBigint(n))}_pushMap(t,e){return!!t._pushInt(e.size,u.MAP)&&this._pushRawMap(e.size,Array.from(e))}_pushObject(t){if(!t)return this._pushUInt8(m);for(var e=this.semanticTypes.length,r=0;r<e;r++)if(t instanceof this.semanticTypes[r][0])return this.semanticTypes[r][1].call(t,this,t);var n=t.encodeCBOR;if("function"==typeof n)return n.call(t,this);var s=Object.keys(t),i=s.length;return!!this._pushInt(i,u.MAP)&&this._pushRawMap(i,s.map(e=>[e,t[e]]))}_pushRawMap(t,e){e=e.map((function(t){return t[0]=I.encode(t[0]),t})).sort(a.keySorter);for(var r=0;r<t;r++){if(!this.push(e[r][0]))return!1;if(!this.pushAny(e[r][1]))return!1}return!0}write(t){return this.pushAny(t)}pushAny(t){switch(function(t){return{}.toString.call(t).slice(8,-1)}(t)){case"Number":return this._pushNumber(t);case"String":return this._pushString(t);case"Boolean":return this._pushBoolean(t);case"Object":return this._pushObject(t);case"Array":return this._pushArray(this,t);case"Uint8Array":return this._pushBuffer(this,n.isBuffer(t)?t:n.from(t));case"Null":return this._pushUInt8(m);case"Undefined":return this._pushUndefined(t);case"Map":return this._pushMap(this,t);case"Set":return this._pushSet(this,t);case"URL":return this._pushUrl(this,t);case"BigNumber":return this._pushBigNumber(this,t);case"Date":return this._pushDate(this,t);case"RegExp":return this._pushRegexp(this,t);case"Symbol":switch(t){case l.NULL:return this._pushObject(null);case l.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+t.toString())}default:throw new Error("Unknown type: "+typeof t+", "+(t?t.toString():""))}}finalize(){if(0===this.offset)return null;for(var t=this.result,e=this.resultLength,r=this.resultMethod,s=this.offset,i=0,a=0;a<s;a++)i+=e[a];var o=n.allocUnsafe(i),u=0,h=0;for(a=0;a<s;a++){switch(h=e[a],r[a]){case 0:t[a].copy(o,u);break;case 1:o.writeUInt8(t[a],u,!0);break;case 2:o.writeUInt16BE(t[a],u,!0);break;case 3:o.writeUInt32BE(t[a],u,!0);break;case 4:o.writeDoubleBE(t[a],u,!0);break;case 5:o.write(t[a],u,h,"utf8");break;default:throw new Error("unkown method")}u+=h}var c=o;return this._reset(),c}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(t){const e=new I;if(!e.pushAny(t))throw new Error("Failed to encode input");return e.finalize()}}t.exports=I},PLHu:function(t,e,r){const{buildBitcoinTxRequest:n}=r("6WMX"),{buildEthereumTxRequest:s,buildEthereumMsgRequest:i,ensureHexBuffer:a}=r("xKF7"),o=r("tjlA").Buffer,u=r("lxpg"),h=r("cC09"),c=r("MzeL"),{AES_IV:l,responseCodes:p,responseMsgs:f,VERSION_BYTE:d}=r("L21C"),g=new(0,c.ec)("p256");function y(t){return h.buf(t)>>>0}t.exports={isValidAssetPath:function(t){const e=2147483648,r=[e,2147483649,2147483708],n=[e];return[2147483697,2147483692].indexOf(t[0])>=0&&r.indexOf(t[1])>=0&&n.indexOf(t[2])>=0&&[0,1].indexOf(t[3])>=0},isValidCoinType:function(t){return[2147483648,2147483649,2147483708].indexOf(t[1])>=0},ensureHexBuffer:a,signReqResolver:{BTC:n,ETH:s,ETH_MSG:i},aes256_decrypt:function(t,e){const r=o.from(l),n=new u.ModeOfOperation.cbc(e,r);return o.from(n.decrypt(t))},aes256_encrypt:function(t,e){const r=o.from(l),n=new u.ModeOfOperation.cbc(e,r),s=t.length%16==0?t:u.padding.pkcs7.pad(t);return o.from(n.encrypt(s))},parseDER:function(t){if(48!==t[0]||2!==t[2])return null;let e=3;const r={r:null,s:null},n=t[e];if(e++,r.r=t.slice(e,e+n),e+=n,2!==t[e])return null;e++;const s=t[e];return e++,r.s=t.slice(e,e+s),r},checksum:y,parseLattice1Response:function(t){const e={err:null,data:null},r=o.from(t,"hex");let n=0;const s=r.readUInt8(n);if(n++,s!==d)return e.err="Incorrect protocol version. Please update your SDK",e;const i=r.readUInt8(n);if(n++,0!==i)return e.err="Incorrect response from Lattice1",e;r.readUInt32BE(n),n+=4;const a=r.readUInt16BE(n);n+=2;const u=r.slice(n,n+a);n+=a;const h=u.readUInt8(0);return h!==p.RESP_SUCCESS?(e.err="Error from device: "+(f[h]?f[h]:"Unknown Error"),e.responseCode=h,e):(e.data=u.slice(1,u.length),r.readUInt32BE(n)!==y(r.slice(0,r.length-4))?(e.err="Invalid checksum from device response",e.data=null,e):e)},getP256KeyPair:function(t){return g.keyFromPrivate(t,"hex")},getP256KeyPairFromPub:function(t){return g.keyFromPublic(t,"hex")},toPaddedDER:function(t){const e=o.alloc(74);return o.from(t.toDER()).copy(e),e}}},PV6L:function(t,e,r){"use strict";const{URLWithLegacySupport:n,format:s}=r("HwtC");t.exports=(t,e={},r={},i)=>{let a,o=e.protocol?e.protocol.replace(":",""):"http";o=(r[o]||i||o)+":";try{a=new n(t)}catch(h){a={}}const u=Object.assign({},e,{protocol:o||a.protocol,host:e.host||a.host});return new n(t,s(u)).toString()}},RP9m:function(t,e,r){const n=r("9lTW"),s=r("tjlA").Buffer;function i(t,e){if("00"===t.slice(0,2))throw new Error("invalid RLP: extra zeros");return parseInt(t,e)}function a(t,e){if(t<56)return new s([t+e]);var r=u(t),n=u(e+55+r.length/2);return new s(n+r,"hex")}function o(t){return"0x"===t.slice(0,2)}function u(t){var e=t.toString(16);return e.length%2&&(e="0"+e),e}function h(t){if(!s.isBuffer(t))if("string"==typeof t)t=o(t)?new s(((r="string"!=typeof(n=t)?n:o(n)?n.slice(2):n).length%2&&(r="0"+r),r),"hex"):new s(t);else if("number"==typeof t)t?(e=u(t),t=new s(e,"hex")):t=new s([]);else if(null==t)t=new s([]);else{if(!t.toArray)throw new Error("invalid type");t=new s(t.toArray())}var e,r,n;return t}e.encode=function(t){if(t instanceof Array){for(var r=[],n=0;n<t.length;n++)r.push(e.encode(t[n]));var i=s.concat(r);return s.concat([a(i.length,192),i])}return 1===(t=h(t)).length&&t[0]<128?t:s.concat([a(t.length,128),t])},e.decode=function(t,e){if(!t||0===t.length)return new s([]);var r=function t(e){var r,n,a,o,u,h=[],c=e[0];if(c<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(c<=183){if(r=c-127,a=128===c?new s([]):e.slice(1,r),2===r&&a[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:a,remainder:e.slice(r)}}if(c<=191){if(r=i(e.slice(1,n=c-182).toString("hex"),16),(a=e.slice(n,r+n)).length<r)throw new Error("invalid RLP");return{data:a,remainder:e.slice(r+n)}}if(c<=247){for(o=e.slice(1,r=c-191);o.length;)u=t(o),h.push(u.data),o=u.remainder;return{data:h,remainder:e.slice(r)}}var l=(n=c-246)+(r=i(e.slice(1,n).toString("hex"),16));if(l>e.length)throw new Error("invalid rlp: total length is larger than the data");if(0===(o=e.slice(n,l)).length)throw new Error("invalid rlp, List has a invalid length");for(;o.length;)u=t(o),h.push(u.data),o=u.remainder;return{data:h,remainder:e.slice(l)}}(t=h(t));return e?r:(n.equal(r.remainder.length,0,"invalid remainder"),r.data)},e.getLength=function(t){if(!t||0===t.length)return new s([]);var e=(t=h(t))[0];if(e<=127)return t.length;if(e<=183)return e-127;if(e<=191)return e-182;if(e<=247)return e-191;var r=e-246;return r+i(t.slice(1,r).toString("hex"),16)}},UHYx:function(t,e,r){"use strict";const n=r("hb4V"),s=n.MT,i=n.SIMPLE,a=n.SYMS;class o{constructor(t){if("number"!=typeof t)throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(0|t)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(t){return t._pushInt(this.value,s.SIMPLE_FLOAT)}static isSimple(t){return t instanceof o}static decode(t,e){switch(null==e&&(e=!0),t){case i.FALSE:return!1;case i.TRUE:return!0;case i.NULL:return e?null:a.NULL;case i.UNDEFINED:return e?void 0:a.UNDEFINED;case-1:if(!e)throw new Error("Invalid BREAK");return a.BREAK;default:return new o(t)}}}t.exports=o},XUzR:function(t,e,r){"use strict";(function(t){e.a=function(e,r,n){void 0===n&&(n=!1);for(var s=n?r.length:e.length,i=t.alloc(s),a=0;a<s;a++)i[a]=e[n?a%e.length:a]&r[a];return i}}).call(this,r("tjlA").Buffer)},XuWj:function(t,e,r){"use strict";const{Buffer:n}=r("tjlA"),s=r("kB5k").BigNumber,i=r("hb4V"),a=i.SHIFT32,o=i.SHIFT16;e.parseHalf=function(t){var e,r,n;return n=128&t[0]?-1:1,r=(3&t[0])<<8|t[1],(e=(124&t[0])>>2)?31===e?n*(r?NaN:Infinity):n*Math.pow(2,e-25)*(1024+r):5.960464477539063e-8*n*r},e.arrayBufferToBignumber=function(t){const e=t.byteLength;let r="";for(let s=0;s<e;s++)r+=(n=t[s])<16?"0"+n.toString(16):n.toString(16);var n;return new s(r,16)},e.buildMap=t=>{const e=new Map,r=Object.keys(t),n=r.length;for(let s=0;s<n;s++)e.set(r[s],t[r[s]]);return e},e.buildInt32=(t,e)=>t*o+e,e.buildInt64=(t,r,n,i)=>{const o=e.buildInt32(t,r),u=e.buildInt32(n,i);return o>2097151?new s(o).times(a).plus(u):o*a+u},e.writeHalf=function(t,e){const r=n.allocUnsafe(4);r.writeFloatBE(e,0);const s=r.readUInt32BE(0);if(0!=(8191&s))return!1;var i=s>>16&32768;const a=s>>23&255,o=8388607&s;if(a>=113&&a<=142)i+=(a-112<<10)+(o>>13);else{if(!(a>=103&&a<113))return!1;if(o&(1<<126-a)-1)return!1;i+=o+8388608>>126-a}return t.writeUInt16BE(i,0),!0},e.keySorter=function(t,e){var r=t[0].byteLength,n=e[0].byteLength;return r>n?1:n>r?-1:t[0].compare(e[0])},e.isNegativeZero=t=>0===t&&1/t<0,e.nextPowerOf2=t=>{let e=0;if(t&&!(t&t-1))return t;for(;0!==t;)t>>=1,e+=1;return 1<<e}},YnKP:function(t,e,r){"use strict";(function(t){e.a=function(e,r,n){void 0===n&&(n=!1);for(var s=n?r.length:e.length,i=t.alloc(s),a=0;a<s;a++)i[a]=e[n?a%e.length:a]|r[a];return i}}).call(this,r("tjlA").Buffer)},aFzb:function(t,e,r){(function(e){const n=r("HEbw"),s=r("+qE3").EventEmitter,i=r("4Mn8"),a=r("jSND").Transaction,o=r("pi6U").default,u=r("tnHP"),h="Lattice Hardware";class c extends s{constructor(t={}){super(),this.type=h,this._resetDefaults(),this.deserialize(t)}deserialize(t={}){return this.hdPath=t.hdPath||"m/44'/60'/0'/0/x",t.creds&&(this.creds=t.creds),t.accounts&&(this.accounts=t.accounts),t.accountIndices&&(this.accountIndices=t.accountIndices),t.walletUID&&(this.walletUID=t.walletUID),t.name&&(this.appName=t.name),t.appName&&(this.appName=t.appName),t.network&&(this.network=t.network),t.page&&(this.page=t.page),Promise.resolve()}setHdPath(t){this.hdPath=t}serialize(){return Promise.resolve({creds:this.creds,accounts:this.accounts,accountIndices:this.accountIndices,walletUID:this.walletUID,appName:this.appName,name:this.name,network:this.network,page:this.page})}isUnlocked(){return this._hasCreds()&&this._hasSession()}unlock(t=!0){return new Promise((e,r)=>{this._getCreds().then(t=>(t&&(this.creds.deviceID=t.deviceID,this.creds.password=t.password,this.creds.endpoint=t.endpoint||null),this._initSession())).then(()=>this._connect(t)).then(()=>e("Unlocked")).catch(t=>r(new Error(t)))})}addAccounts(t=1){return new Promise((e,r)=>-1e3===t?(this.forgetDevice(),e([])):t<=0?r("Number of accounts to add must be a positive number."):void this.unlock().then(()=>this._fetchAddresses(t,this.unlockedAccount)).then(t=>(t.forEach((t,e)=>{-1===this.accounts.indexOf(t)&&(this.accounts.push(t),this.accountIndices.push(this.unlockedAccount+e))}),e(this.accounts))).catch(t=>r(new Error(t))))}getAccounts(){return Promise.resolve(this.accounts?this.accounts.slice():[].slice())}signTransaction(t,r){return new Promise((n,s)=>{this._unlockAndFindAccount(t).then(t=>{const e={chainId:r.getChainId()||1,nonce:"0x"+r.nonce.toString("hex")||0,gasPrice:"0x"+r.gasPrice.toString("hex"),gasLimit:"0x"+r.gasLimit.toString("hex"),to:"0x"+r.to.toString("hex"),value:"0x"+r.value.toString("hex"),data:0===r.data.length?null:"0x"+r.data.toString("hex"),signerPath:this._getHDPathIndices(t)};return this._signTxData(e)}).then(i=>{if(!(i.sig&&i.sig.v&&i.sig.r&&i.sig.s))return s(new Error("No signature returned."));r.r=e.from(i.sig.r,"hex"),r.s=e.from(i.sig.s,"hex"),r.v=i.sig.v;const h=1!==r.getChainId()&&parseInt("0x"+r.v.toString("hex"))>28,c=o.forCustomChain("mainnet",{name:"notMainnet",networkId:r.getChainId(),chainId:r.getChainId()},"byzantium");let l;l=1==h?new a(r,{common:c}):new a(r);const p=u.toChecksumAddress("0x"+l.from.toString("hex")),f=u.toChecksumAddress(t);return p!==f?s(new Error(`Unexpected signer. Got ${p}. Expected ${f}`)):n(r)}).catch(t=>s(new Error(t)))})}signPersonalMessage(t,e){return this.signMessage(t,{payload:e,protocol:"signPersonal"})}signTypedData(t,e,r){if(r.version&&"V4"!==r.version&&"V3"!==r.version)throw new Error("Only signTypedData V3 and V4 messages (EIP712) are supported. Got version "+r.version);return this.signMessage(t,{payload:e,protocol:"eip712"})}signMessage(t,e){return new Promise((r,n)=>{this._unlockAndFindAccount(t).then(t=>{const{payload:s,protocol:i}=e;if(!s||!i)return n("`payload` and `protocol` fields must be included in the request");const a={currency:"ETH_MSG",data:{protocol:i,payload:s,signerPath:this._getHDPathIndices(t)}};if(!this._hasSession())return n("No SDK session started. Cannot sign transaction.");this.sdkSession.sign(a,(t,e)=>{if(t)return n(new Error(t));if(!e.sig)return n(new Error("No signature returned"));try{let t=e.sig.v.toString("hex");return t.length<2&&(t="0"+t),r(`0x${e.sig.r}${e.sig.s}${t}`)}catch(t){return n(new Error("Invalid signature format returned."))}})})})}exportAccount(t){return Promise.reject(Error("exportAccount not supported by this device"))}removeAccount(t){this.forgetDevice()}getFirstPage(){return this.page=0,this._getPage(0)}getNextPage(){return this._getPage(1)}getPreviousPage(){return this._getPage(-1)}setAccountToUnlock(t){this.unlockedAccount=parseInt(t,10)}forgetDevice(){this._resetDefaults()}_unlockAndFindAccount(t){return new Promise((e,r)=>{this.unlock(!1).then(()=>this.getAccounts()).then(n=>{let s=null;return n.forEach((e,r)=>{t.toLowerCase()===e.toLowerCase()&&(s=r)}),null===s?r("Signer not present"):e(this.accountIndices[s])}).catch(t=>r(t))})}_getHDPathIndices(t=0){const e=this.hdPath.split("/").slice(1),r=[];let n=!1;if(e.forEach(e=>{const s="'"===e[e.length-1];let i=s?2147483648:0;e.indexOf("x")>-1?(i+=t,n=!0):i+=Number(s?e.slice(0,e.length-1):e),r.push(i)}),!1===n&&r.push(t),r.length>5)throw new Error("Only HD paths with up to 5 indices are allowed.");return r}_resetDefaults(){this.accounts=[],this.accountIndices=[],this.isLocked=!0,this.creds={deviceID:null,password:null,endpoint:null},this.walletUID=null,this.sdkSession=null,this.page=0,this.unlockedAccount=0,this.network=null}_getCreds(){return new Promise((t,e)=>{if(this._hasCreds())return t();const r=this.appName?this.appName:"Unknown";let n="https://wallet.gridplus.io";switch(this.network){case"rinkeby":n="https://gridplus-web-wallet-dev.herokuapp.com"}let s=`${n}?keyring=${r}`;this.network&&(s+="&network="+this.network),window.open(s).postMessage("GET_LATTICE_CREDS",n),window.addEventListener("message",(function(r){if(r.origin===n)try{const n=JSON.parse(r.data);return n.deviceID&&n.password?t(n):e(Error("Invalid credentials returned from Lattice."))}catch(s){return e(s)}}),!1)})}_connect(t){return new Promise((e,r)=>{this.sdkSession.connect(this.creds.deviceID,n=>{if(n)return r(n);const s=this.sdkSession.getActiveWallet();if(!s||!s.uid)return r("No active wallet");const i=s.uid.toString("hex");if(i!=this.walletUID){if(!1===t)return r("Wallet has changed! Please reconnect.");this.accounts=[],this.walletUID=i}return e()})})}_initSession(){return new Promise((t,e)=>{if(this._hasSession())return t();try{let e="https://signing.gridpl.us";this.network&&"mainnet"!==this.network&&(e="https://signing.staging-gridpl.us"),this.creds.endpoint&&(e=this.creds.endpoint);const r={name:this.appName,baseUrl:e,crypto:n,timeout:12e4,privKey:this._genSessionKey(),network:this.network};return this.sdkSession=new i.Client(r),t()}catch(r){return e(r)}})}_fetchAddresses(t=1,e=0,r=[]){return new Promise((r,n)=>this._hasSession()?this.accounts.length>e+t?r(this.accounts.slice(e,t)):void this.__fetchAddresses(t,e,(t,e)=>t?n(t):r(e)):n("No SDK session started. Cannot fetch addresses."))}__fetchAddresses(t=1,e=0,r,n=[]){if(0===t)return r(null,n);const s=this._hdPathHasInternalVarIdx(),i={currency:"ETH",startPath:this._getHDPathIndices(e),n:s?1:t,skipCache:!0};this.sdkSession.getAddresses(i,(i,a)=>i?r("Error fetching addresses: "+i):a.length<1?r("No addresses returned"):s?this.__fetchAddresses(t-1,e+1,r,n.concat(a)):r(null,a))}_signTxData(t){return new Promise((e,r)=>{if(!this._hasSession())return r("No SDK session started. Cannot sign transaction.");this.sdkSession.sign({currency:"ETH",data:t},(t,n)=>t?r(t):n.tx?e(n):r("No transaction payload returned."))})}_getPage(t=0){return new Promise((e,r)=>{this.page+=t,this.page<0&&(this.page=0);const n=5*this.page;this.unlock().then(()=>this._fetchAddresses(5,n)).then(t=>{const r=[];return t.forEach((t,e)=>{r.push({address:t,balance:null,index:n+e})}),e(r)}).catch(t=>r(t))})}_hasCreds(){return null!==this.creds.deviceID&&null!==this.creds.password&&this.appName}_hasSession(){return this.sdkSession&&this.walletUID}_genSessionKey(){if(this.name&&!this.appName&&(this.appName=this.name),!this._hasCreds())throw new Error("No credentials -- cannot create session key!");const t=e.concat([e.from(this.creds.password),e.from(this.creds.deviceID),e.from(this.appName)]);return n.createHash("sha256").update(t).digest()}_hdPathHasInternalVarIdx(){const t=this.hdPath.split("/").slice(1);for(let e=0;e<t.length-1;e++)if(t[e].indexOf("x")>-1)return!0;return!1}}c.type=h,t.exports=c}).call(this,r("tjlA").Buffer)},cC09:function(t,e,r){var n;n=function(t){t.version="1.2.0";var e=function(){for(var t=0,e=new Array(256),r=0;256!=r;++r)e[r]=t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=r)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1;return"undefined"!=typeof Int32Array?new Int32Array(e):e}();t.table=e,t.bstr=function(t,r){for(var n=-1^r,s=t.length-1,i=0;i<s;)n=(n=n>>>8^e[255&(n^t.charCodeAt(i++))])>>>8^e[255&(n^t.charCodeAt(i++))];return i===s&&(n=n>>>8^e[255&(n^t.charCodeAt(i))]),-1^n},t.buf=function(t,r){if(t.length>1e4)return function(t,r){for(var n=-1^r,s=t.length-7,i=0;i<s;)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])];for(;i<s+7;)n=n>>>8^e[255&(n^t[i++])];return-1^n}(t,r);for(var n=-1^r,s=t.length-3,i=0;i<s;)n=(n=(n=(n=n>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])])>>>8^e[255&(n^t[i++])];for(;i<s+3;)n=n>>>8^e[255&(n^t[i++])];return-1^n},t.str=function(t,r){for(var n,s,i=-1^r,a=0,o=t.length;a<o;)(n=t.charCodeAt(a++))<128?i=i>>>8^e[255&(i^n)]:n<2048?i=(i=i>>>8^e[255&(i^(192|n>>6&31))])>>>8^e[255&(i^(128|63&n))]:n>=55296&&n<57344?(n=64+(1023&n),s=1023&t.charCodeAt(a++),i=(i=(i=(i=i>>>8^e[255&(i^(240|n>>8&7))])>>>8^e[255&(i^(128|n>>2&63))])>>>8^e[255&(i^(128|s>>6&15|(3&n)<<4))])>>>8^e[255&(i^(128|63&s))]):i=(i=(i=i>>>8^e[255&(i^(224|n>>12&15))])>>>8^e[255&(i^(128|n>>6&63))])>>>8^e[255&(i^(128|63&n))];return-1^i}},"undefined"==typeof DO_NOT_EXPORT_CRC?n(e):n({})},cpc2:function(t,e,r){function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<n.length;s++)if((r=n[s])===e||r.fn===e){n.splice(s,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){n=0;for(var s=(r=r.slice(0)).length;n<s;++n)r[n].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},f7RY:function(t,e,r){"use strict";(function(t){e.a=function(e){for(var r=t.alloc(e.length),n=0;n<e.length;n++)r[n]=~e[n];return r}}).call(this,r("tjlA").Buffer)},gYz7:function(t,e){t.exports=function(t,e,r){"use asm";var n=new t.Uint8Array(r);var s=e.pushInt;var i=e.pushInt32;var a=e.pushInt32Neg;var o=e.pushInt64;var u=e.pushInt64Neg;var h=e.pushFloat;var c=e.pushFloatSingle;var l=e.pushFloatDouble;var p=e.pushTrue;var f=e.pushFalse;var d=e.pushUndefined;var g=e.pushNull;var y=e.pushInfinity;var _=e.pushInfinityNeg;var E=e.pushNaN;var m=e.pushNaNNeg;var w=e.pushArrayStart;var S=e.pushArrayStartFixed;var b=e.pushArrayStartFixed32;var v=e.pushArrayStartFixed64;var I=e.pushObjectStart;var T=e.pushObjectStartFixed;var A=e.pushObjectStartFixed32;var R=e.pushObjectStartFixed64;var x=e.pushByteString;var P=e.pushByteStringStart;var N=e.pushUtf8String;var U=e.pushUtf8StringStart;var D=e.pushSimpleUnassigned;var L=e.pushTagStart;var B=e.pushTagStart4;var O=e.pushTagStart8;var k=e.pushTagUnassigned;var F=e.pushBreak;var C=t.Math.pow;var M=0;var H=0;var j=0;function q(t){t=t|0;M=0;H=t;while((M|0)<(H|0)){j=Xt[n[M]&255](n[M]|0)|0;if((j|0)>0){break}}return j|0}function G(t){t=t|0;if(((M|0)+(t|0)|0)<(H|0)){return 0}return 1}function z(t){t=t|0;return n[t|0]<<8|n[t+1|0]|0}function W(t){t=t|0;return n[t|0]<<24|n[t+1|0]<<16|n[t+2|0]<<8|n[t+3|0]|0}function $(t){t=t|0;s(t|0);M=M+1|0;return 0}function Y(t){t=t|0;if(G(1)|0){return 1}s(n[M+1|0]|0);M=M+2|0;return 0}function K(t){t=t|0;if(G(2)|0){return 1}s(z(M+1|0)|0);M=M+3|0;return 0}function V(t){t=t|0;if(G(4)|0){return 1}i(z(M+1|0)|0,z(M+3|0)|0);M=M+5|0;return 0}function X(t){t=t|0;if(G(8)|0){return 1}o(z(M+1|0)|0,z(M+3|0)|0,z(M+5|0)|0,z(M+7|0)|0);M=M+9|0;return 0}function J(t){t=t|0;s(-1-(t-32|0)|0);M=M+1|0;return 0}function Z(t){t=t|0;if(G(1)|0){return 1}s(-1-(n[M+1|0]|0)|0);M=M+2|0;return 0}function Q(t){t=t|0;var e=0;if(G(2)|0){return 1}e=z(M+1|0)|0;s(-1-(e|0)|0);M=M+3|0;return 0}function tt(t){t=t|0;if(G(4)|0){return 1}a(z(M+1|0)|0,z(M+3|0)|0);M=M+5|0;return 0}function et(t){t=t|0;if(G(8)|0){return 1}u(z(M+1|0)|0,z(M+3|0)|0,z(M+5|0)|0,z(M+7|0)|0);M=M+9|0;return 0}function rt(t){t=t|0;var e=0;var r=0;var n=0;n=t-64|0;if(G(n|0)|0){return 1}e=M+1|0;r=(M+1|0)+(n|0)|0;x(e|0,r|0);M=r|0;return 0}function nt(t){t=t|0;var e=0;var r=0;var s=0;if(G(1)|0){return 1}s=n[M+1|0]|0;e=M+2|0;r=(M+2|0)+(s|0)|0;if(G(s+1|0)|0){return 1}x(e|0,r|0);M=r|0;return 0}function st(t){t=t|0;var e=0;var r=0;var n=0;if(G(2)|0){return 1}n=z(M+1|0)|0;e=M+3|0;r=(M+3|0)+(n|0)|0;if(G(n+2|0)|0){return 1}x(e|0,r|0);M=r|0;return 0}function it(t){t=t|0;var e=0;var r=0;var n=0;if(G(4)|0){return 1}n=W(M+1|0)|0;e=M+5|0;r=(M+5|0)+(n|0)|0;if(G(n+4|0)|0){return 1}x(e|0,r|0);M=r|0;return 0}function at(t){t=t|0;return 1}function ot(t){t=t|0;P();M=M+1|0;return 0}function ut(t){t=t|0;var e=0;var r=0;var n=0;n=t-96|0;if(G(n|0)|0){return 1}e=M+1|0;r=(M+1|0)+(n|0)|0;N(e|0,r|0);M=r|0;return 0}function ht(t){t=t|0;var e=0;var r=0;var s=0;if(G(1)|0){return 1}s=n[M+1|0]|0;e=M+2|0;r=(M+2|0)+(s|0)|0;if(G(s+1|0)|0){return 1}N(e|0,r|0);M=r|0;return 0}function ct(t){t=t|0;var e=0;var r=0;var n=0;if(G(2)|0){return 1}n=z(M+1|0)|0;e=M+3|0;r=(M+3|0)+(n|0)|0;if(G(n+2|0)|0){return 1}N(e|0,r|0);M=r|0;return 0}function lt(t){t=t|0;var e=0;var r=0;var n=0;if(G(4)|0){return 1}n=W(M+1|0)|0;e=M+5|0;r=(M+5|0)+(n|0)|0;if(G(n+4|0)|0){return 1}N(e|0,r|0);M=r|0;return 0}function pt(t){t=t|0;return 1}function ft(t){t=t|0;U();M=M+1|0;return 0}function dt(t){t=t|0;S(t-128|0);M=M+1|0;return 0}function gt(t){t=t|0;if(G(1)|0){return 1}S(n[M+1|0]|0);M=M+2|0;return 0}function yt(t){t=t|0;if(G(2)|0){return 1}S(z(M+1|0)|0);M=M+3|0;return 0}function _t(t){t=t|0;if(G(4)|0){return 1}b(z(M+1|0)|0,z(M+3|0)|0);M=M+5|0;return 0}function Et(t){t=t|0;if(G(8)|0){return 1}v(z(M+1|0)|0,z(M+3|0)|0,z(M+5|0)|0,z(M+7|0)|0);M=M+9|0;return 0}function mt(t){t=t|0;w();M=M+1|0;return 0}function wt(t){t=t|0;var e=0;e=t-160|0;if(G(e|0)|0){return 1}T(e|0);M=M+1|0;return 0}function St(t){t=t|0;if(G(1)|0){return 1}T(n[M+1|0]|0);M=M+2|0;return 0}function bt(t){t=t|0;if(G(2)|0){return 1}T(z(M+1|0)|0);M=M+3|0;return 0}function vt(t){t=t|0;if(G(4)|0){return 1}A(z(M+1|0)|0,z(M+3|0)|0);M=M+5|0;return 0}function It(t){t=t|0;if(G(8)|0){return 1}R(z(M+1|0)|0,z(M+3|0)|0,z(M+5|0)|0,z(M+7|0)|0);M=M+9|0;return 0}function Tt(t){t=t|0;I();M=M+1|0;return 0}function At(t){t=t|0;L(t-192|0|0);M=M+1|0;return 0}function Rt(t){t|0;L(t|0);M=M+1|0;return 0}function xt(t){t|0;L(t|0);M=M+1|0;return 0}function Pt(t){t|0;L(t|0);M=M+1|0;return 0}function Nt(t){t|0;L(t|0);M=M+1|0;return 0}function Ut(t){t=t|0;L(t-192|0|0);M=M+1|0;return 0}function Dt(t){t|0;L(t|0);M=M+1|0;return 0}function Lt(t){t|0;L(t|0);M=M+1|0;return 0}function Bt(t){t|0;L(t|0);M=M+1|0;return 0}function Ot(t){t=t|0;if(G(1)|0){return 1}L(n[M+1|0]|0);M=M+2|0;return 0}function kt(t){t=t|0;if(G(2)|0){return 1}L(z(M+1|0)|0);M=M+3|0;return 0}function Ft(t){t=t|0;if(G(4)|0){return 1}B(z(M+1|0)|0,z(M+3|0)|0);M=M+5|0;return 0}function Ct(t){t=t|0;if(G(8)|0){return 1}O(z(M+1|0)|0,z(M+3|0)|0,z(M+5|0)|0,z(M+7|0)|0);M=M+9|0;return 0}function Mt(t){t=t|0;D((t|0)-224|0);M=M+1|0;return 0}function Ht(t){t=t|0;f();M=M+1|0;return 0}function jt(t){t=t|0;p();M=M+1|0;return 0}function qt(t){t=t|0;g();M=M+1|0;return 0}function Gt(t){t=t|0;d();M=M+1|0;return 0}function zt(t){t=t|0;if(G(1)|0){return 1}D(n[M+1|0]|0);M=M+2|0;return 0}function Wt(t){t=t|0;var e=0;var r=0;var s=1.0;var i=0.0;var a=0.0;var o=0.0;if(G(2)|0){return 1}e=n[M+1|0]|0;r=n[M+2|0]|0;if((e|0)&0x80){s=-1.0}i=+(((e|0)&0x7C)>>2);a=+(((e|0)&0x03)<<8|r);if(+i==0.0){h(+(+s*+5.9604644775390625e-8*+a))}else if(+i==31.0){if(+s==1.0){if(+a>0.0){E()}else{y()}}else{if(+a>0.0){m()}else{_()}}}else{h(+(+s*C(+2,+(+i-25.0))*+(1024.0+a)))}M=M+3|0;return 0}function $t(t){t=t|0;if(G(4)|0){return 1}c(n[M+1|0]|0,n[M+2|0]|0,n[M+3|0]|0,n[M+4|0]|0);M=M+5|0;return 0}function Yt(t){t=t|0;if(G(8)|0){return 1}l(n[M+1|0]|0,n[M+2|0]|0,n[M+3|0]|0,n[M+4|0]|0,n[M+5|0]|0,n[M+6|0]|0,n[M+7|0]|0,n[M+8|0]|0);M=M+9|0;return 0}function Kt(t){t=t|0;return 1}function Vt(t){t=t|0;F();M=M+1|0;return 0}var Xt=[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Y,K,V,X,Kt,Kt,Kt,Kt,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,Z,Q,tt,et,Kt,Kt,Kt,Kt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,nt,st,it,at,Kt,Kt,Kt,ot,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ut,ht,ct,lt,pt,Kt,Kt,Kt,ft,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,dt,gt,yt,_t,Et,Kt,Kt,Kt,mt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,St,bt,vt,It,Kt,Kt,Kt,Tt,At,At,At,At,At,At,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ot,kt,Ft,Ct,Kt,Kt,Kt,Kt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Ht,jt,qt,Gt,zt,Wt,$t,Yt,Kt,Kt,Kt,Vt];return{parse:q}}},hDHj:function(t,e,r){"use strict";(function(e){const{Buffer:n}=r("tjlA"),s=r("kVK+"),i=r("kB5k").BigNumber,a=r("gYz7"),o=r("XuWj"),u=r("hb4V"),h=r("UHYx"),c=r("IrRL"),{URL:l}=r("Fq86");class p{constructor(t){(t=t||{}).size=!t.size||t.size<65536?65536:o.nextPowerOf2(t.size),this._heap=new ArrayBuffer(t.size),this._heap8=new Uint8Array(this._heap),this._buffer=n.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(1e3*t),2:t=>o.arrayBufferToBignumber(t),3:t=>u.NEG_ONE.minus(o.arrayBufferToBignumber(t)),4:t=>u.TEN.pow(t[0]).times(t[1]),5:t=>u.TWO.pow(t[0]).times(t[1]),32:t=>new l(t),35:t=>new RegExp(t)},t.tags),this.parser=a(e,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var t=this._parents.pop();if(t.length>0)throw new Error(`Missing ${t.length} elements`);switch(t.type){case u.PARENT.TAG:this._push(this.createTag(t.ref[0],t.ref[1]));break;case u.PARENT.BYTE_STRING:this._push(this.createByteString(t.ref,t.length));break;case u.PARENT.UTF8_STRING:this._push(this.createUtf8String(t.ref,t.length));break;case u.PARENT.MAP:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(t.ref,t.length));break;case u.PARENT.OBJECT:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(t.ref,t.length));break;case u.PARENT.ARRAY:this._push(this.createArray(t.ref,t.length))}this._currentParent&&this._currentParent.type===u.PARENT.TAG&&this._dec()}_dec(){const t=this._currentParent;t.length<0||(t.length--,0===t.length&&this._closeParent())}_push(t,e){const r=this._currentParent;switch(r.values++,r.type){case u.PARENT.ARRAY:case u.PARENT.BYTE_STRING:case u.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=t:this._ref.push(t),this._dec();break;case u.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=t,r.tmpKey=null,this._dec()):(r.tmpKey=t,"string"!=typeof r.tmpKey&&(r.type=u.PARENT.MAP,r.ref=o.buildMap(r.ref)));break;case u.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,t),r.tmpKey=null,this._dec()):r.tmpKey=t;break;case u.PARENT.TAG:this._ref.push(t),e||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(t,e,r){this._parents[this._depth]={type:e,length:r,ref:t,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:u.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(t,e){const r=this._knownTags[t];return r?r(e):new c(t,e)}createMap(t,e){return t}createObject(t,e){return t}createArray(t,e){return t}createByteString(t,e){return n.concat(t)}createByteStringFromHeap(t,e){return t===e?n.alloc(0):n.from(this._heap.slice(t,e))}createInt(t){return t}createInt32(t,e){return o.buildInt32(t,e)}createInt64(t,e,r,n){return o.buildInt64(t,e,r,n)}createFloat(t){return t}createFloatSingle(t,e,r,n){return s.read([t,e,r,n],0,!1,23,4)}createFloatDouble(t,e,r,n,i,a,o,u){return s.read([t,e,r,n,i,a,o,u],0,!1,52,8)}createInt32Neg(t,e){return-1-o.buildInt32(t,e)}createInt64Neg(t,e,r,n){const s=o.buildInt32(t,e),a=o.buildInt32(r,n);return s>u.MAX_SAFE_HIGH?u.NEG_ONE.minus(new i(s).times(u.SHIFT32).plus(a)):-1-(s*u.SHIFT32+a)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(t,e){return t.join("")}createUtf8StringFromHeap(t,e){return t===e?"":this._buffer.toString("utf8",t,e)}createSimpleUnassigned(t){return new h(t)}pushInt(t){this._push(this.createInt(t))}pushInt32(t,e){this._push(this.createInt32(t,e))}pushInt64(t,e,r,n){this._push(this.createInt64(t,e,r,n))}pushFloat(t){this._push(this.createFloat(t))}pushFloatSingle(t,e,r,n){this._push(this.createFloatSingle(t,e,r,n))}pushFloatDouble(t,e,r,n,s,i,a,o){this._push(this.createFloatDouble(t,e,r,n,s,i,a,o))}pushInt32Neg(t,e){this._push(this.createInt32Neg(t,e))}pushInt64Neg(t,e,r,n){this._push(this.createInt64Neg(t,e,r,n))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],u.PARENT.ARRAY,-1)}pushArrayStartFixed(t){this._createArrayStartFixed(t)}pushArrayStartFixed32(t,e){const r=o.buildInt32(t,e);this._createArrayStartFixed(r)}pushArrayStartFixed64(t,e,r,n){const s=o.buildInt64(t,e,r,n);this._createArrayStartFixed(s)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(t){this._createObjectStartFixed(t)}pushObjectStartFixed32(t,e){const r=o.buildInt32(t,e);this._createObjectStartFixed(r)}pushObjectStartFixed64(t,e,r,n){const s=o.buildInt64(t,e,r,n);this._createObjectStartFixed(s)}pushByteStringStart(){this._parents[this._depth]={type:u.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(t,e){this._push(this.createByteStringFromHeap(t,e))}pushUtf8StringStart(){this._parents[this._depth]={type:u.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(t,e){this._push(this.createUtf8StringFromHeap(t,e))}pushSimpleUnassigned(t){this._push(this.createSimpleUnassigned(t))}pushTagStart(t){this._parents[this._depth]={type:u.PARENT.TAG,length:1,ref:[t]}}pushTagStart4(t,e){this.pushTagStart(o.buildInt32(t,e))}pushTagStart8(t,e,r,n){this.pushTagStart(o.buildInt64(t,e,r,n))}pushTagUnassigned(t){this._push(this.createTag(t))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(t){0!==t?this._createParent({},u.PARENT.OBJECT,t):this._push(this.createObject({}))}_createArrayStartFixed(t){0!==t?this._createParent(new Array(t),u.PARENT.ARRAY,t):this._push(this.createArray([]))}_decode(t){if(0===t.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(t);const e=this.parser.parse(t.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(e>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(t){return this._decode(t),this._res[0]}decodeAll(t){return this._decode(t),this._res}static decode(t,e){return"string"==typeof t&&(t=n.from(t,e||"hex")),new p({size:t.length}).decodeFirst(t)}static decodeAll(t,e){return"string"==typeof t&&(t=n.from(t,e||"hex")),new p({size:t.length}).decodeAll(t)}}p.decodeFirst=p.decode,t.exports=p}).call(this,r("yLpj"))},hb4V:function(t,e,r){"use strict";const n=r("kB5k").BigNumber;e.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},e.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},e.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},e.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},e.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},e.SHIFT32=Math.pow(2,32),e.SHIFT16=Math.pow(2,16),e.MAX_SAFE_HIGH=2097151,e.NEG_ONE=new n(-1),e.TEN=new n(10),e.TWO=new n(2),e.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5}},jpl7:function(t,e,r){"use strict";const{Buffer:n}=r("tjlA"),s=r("hDHj"),i=r("XuWj");class a extends s{createTag(t,e){return`${t}(${e})`}createInt(t){return super.createInt(t).toString()}createInt32(t,e){return super.createInt32(t,e).toString()}createInt64(t,e,r,n){return super.createInt64(t,e,r,n).toString()}createInt32Neg(t,e){return super.createInt32Neg(t,e).toString()}createInt64Neg(t,e,r,n){return super.createInt64Neg(t,e,r,n).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(t){const e=super.createFloat(t);return i.isNegativeZero(t)?"-0_1":e+"_1"}createFloatSingle(t,e,r,n){return super.createFloatSingle(t,e,r,n)+"_2"}createFloatDouble(t,e,r,n,s,i,a,o){return super.createFloatDouble(t,e,r,n,s,i,a,o)+"_3"}createByteString(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:"h'"+r}createByteStringFromHeap(t,e){return`h'${n.from(super.createByteStringFromHeap(t,e)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(t){return`simple(${t})`}createArray(t,e){const r=super.createArray(t,e);return-1===e?`[_ ${r.join(", ")}]`:`[${r.join(", ")}]`}createMap(t,e){const r=super.createMap(t),n=Array.from(r.keys()).reduce(o(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createObject(t,e){const r=super.createObject(t),n=Object.keys(r).reduce(o(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createUtf8String(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`"${r}"`}createUtf8StringFromHeap(t,e){return`"${n.from(super.createUtf8StringFromHeap(t,e)).toString("utf8")}"`}static diagnose(t,e){return"string"==typeof t&&(t=n.from(t,e||"hex")),(new a).decodeFirst(t)}}function o(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}t.exports=a},kMlx:function(t,e,r){"use strict";var n=r("8zgK");function s(t){if(t)return function(t){for(var e in s.prototype)t[e]=s.prototype[e];return t}(t)}t.exports=s,s.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},s.prototype.parse=function(t){return this._parser=t,this},s.prototype.responseType=function(t){return this._responseType=t,this},s.prototype.serialize=function(t){return this._serializer=t,this},s.prototype.timeout=function(t){if(!t||"object"!=typeof t)return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;default:console.warn("Unknown timeout option",e)}return this},s.prototype.retry=function(t,e){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var i=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];s.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(t,e);if(!0===r)return!0;if(!1===r)return!1}catch(n){console.error(n)}if(e&&e.status&&e.status>=500&&501!=e.status)return!0;if(t){if(t.code&&~i.indexOf(t.code))return!0;if(t.timeout&&"ECONNABORTED"==t.code)return!0;if(t.crossDomain)return!0}return!1},s.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},s.prototype.then=function(t,e){if(!this._fullfilledPromise){var r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((function(t,e){r.end((function(r,n){r?e(r):t(n)}))}))}return this._fullfilledPromise.then(t,e)},s.prototype.catch=function(t){return this.then(void 0,t)},s.prototype.use=function(t){return t(this),this},s.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},s.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&t.status<300)},s.prototype.getHeader=s.prototype.get=function(t){return this._header[t.toLowerCase()]},s.prototype.set=function(t,e){if(n(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},s.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},s.prototype.field=function(t,e){if(null==t)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),n(t)){for(var r in t)this.field(r,t[r]);return this}if(Array.isArray(e)){for(var s in e)this.field(t,e[s]);return this}if(null==e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=""+e),this._getFormData().append(t,e),this},s.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},s.prototype._auth=function(t,e,r,n){switch(r.type){case"basic":this.set("Authorization","Basic "+n(t+":"+e));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+t)}return this},s.prototype.withCredentials=function(t){return null==t&&(t=!0),this._withCredentials=t,this},s.prototype.redirects=function(t){return this._maxRedirects=t,this},s.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw TypeError("Invalid argument");return this._maxResponseSize=t,this},s.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},s.prototype.send=function(t){var e=n(t),r=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(e&&n(this._data))for(var s in t)this._data[s]=t[s];else"string"==typeof t?(r||this.type("form"),this._data="application/x-www-form-urlencoded"==(r=this._header["content-type"])?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)||r||this.type("json"),this},s.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},s.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var r=this.url.substring(e+1).split("&");"function"==typeof this._sort?r.sort(this._sort):r.sort(),this.url=this.url.substring(0,e)+"?"+r.join("&")}}},s.prototype._appendQueryString=function(){console.trace("Unsupported")},s.prototype._timeoutError=function(t,e,r){if(!this._aborted){var n=new Error(t+e+"ms exceeded");n.timeout=e,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.abort(),this.callback(n)}},s.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout((function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")}),this._responseTimeout))}},nMdu:function(t,e,r){"use strict";(function(t){e.a=function(e,r,n){void 0===n&&(n=!1);for(var s=n?r.length:e.length,i=t.alloc(s),a=0;a<s;a++)i[a]=~(e[n?a%e.length:a]&r[a]);return i}}).call(this,r("tjlA").Buffer)},nZbv:function(t,e){function r(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach((function(t){r.prototype[t]=function(){return this._defaults.push({fn:t,arguments:arguments}),this}})),r.prototype._setDefaults=function(t){this._defaults.forEach((function(e){t[e.fn].apply(t,e.arguments)}))},t.exports=r},oHnp:function(t,e,r){"use strict";e.type=function(t){return t.split(/ *; */).shift()},e.params=function(t){return t.split(/ *; */).reduce((function(t,e){var r=e.split(/ *= */),n=r.shift(),s=r.shift();return n&&s&&(t[n]=s),t}),{})},e.parseLinks=function(t){return t.split(/ *, */).reduce((function(t,e){var r=e.split(/ *; */),n=r[0].slice(1,-1);return t[r[1].split(/ *= */)[1].slice(1,-1)]=n,t}),{})},e.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t}},pzNo:function(t,e,r){const n=r("2k3W"),s=r("24Ii"),i=r("6WMX"),a=r("xKF7"),{buildAddAbiPayload:o,abiParsers:u,MAX_ABI_DEFS:h}=r("u0zn"),{isValidAssetPath:c,isValidCoinType:l,signReqResolver:p,aes256_decrypt:f,aes256_encrypt:d,parseDER:g,checksum:y,ensureHexBuffer:_,getP256KeyPair:E,getP256KeyPairFromPub:m,parseLattice1Response:w,toPaddedDER:S}=r("PLHu"),{getFwVersionConst:b,ADDR_STR_LEN:v,ENC_MSG_LEN:I,decResLengths:T,deviceCodes:A,encReqCodes:R,responseCodes:x,REQUEST_TYPE_BYTE:P,VERSION_BYTE:N,messageConstants:U,BASE_URL:D,signingSchema:L}=r("L21C"),B=r("tjlA").Buffer,O=B.alloc(32);t.exports=class{constructor({baseUrl:t,crypto:e,name:r,privKey:n,timeout:s,retryCount:i}={}){if(r&&r.length>24)throw new Error("name must be less than 24 characters");if(!e)throw new Error("crypto provider is required");this.baseUrl=t||D,this.crypto=e,this.name=r||"Unknown",this.privKey=n||this.crypto.randomBytes(32),this.key=E(this.privKey),this.ephemeralPub=null,this.sharedSecret=null,this.timeout=s||6e4,this.deviceId=null,this.isPaired=!1,this.retryCount=i||3,this.activeWallets={internal:{uid:O,name:null,capabilities:null,external:!1},external:{uid:O,name:null,capabilities:null,external:!0}}}connect(t,e){if("function"==typeof t){if(!this.deviceId)return e("No device ID has been stored. Please connect with your device ID first.");e=t}else this.deviceId=t;const r=this._buildRequest(A.CONNECT,this.pubKeyBytes());this._request(r,(t,r)=>t?e(t):(this.isPaired=this._handleConnect(r)||!1,this.isPaired?void this._getActiveWallet(t=>e(t,this.isPaired),!0):e(null)))}pair(t,e){const r=this.pubKeyBytes(),n=B.alloc(25);if(this.name.length>24)return e("Name is too many characters. Please change it to <25 characters.");n.write(this.name);const s=B.concat([r,n,B.from(t)]),i=this.crypto.createHash("sha256").update(s).digest(),a=this.key.sign(i),o=S(a),u=B.concat([n,o]),h=this._buildEncRequest(R.FINALIZE_PAIRING,u);this._request(h,(t,r)=>{if(t)return e(t);const n=this._handlePair(r);if(n)return e(n);this._getActiveWallet(t=>t?e(t):e(null,this.hasActiveWallet()),!0)})}test(t,e){if(!t.payload)return e("First argument must contain `testID` and `payload` fields.");const r=B.alloc(506);r.writeUInt32BE(t.testID,0),r.writeUInt16BE(t.payload.length,4),t.payload.copy(r,6);const n=this._buildEncRequest(R.TEST,r);this._request(n,(t,r)=>{if(t)return e(t);const n=this._handleEncResponse(r,T.test);return null!==n.err?e(n.err):e(null,n.data.slice(65))})}getAddresses(t,e){const{startPath:r,n:s,skipCache:i=!0}=t;if(void 0===r||void 0===s)return e("Please provide `startPath` and `n` options");if(r.length<2||r.length>5)return e("Path must include between 2 and 5 indices");if(s>10)return e("You may only request 10 addresses at once.");if(!1===i&&!1===c(r)||!0===i&&!1===l(r))return e("Parent path is not supported");const a=b(this.fwVersion);let o=53;if(a.varAddrPathSzAllowed)o+=1;else if(5!==r.length)return e("Your Lattice firmware only supports derivation paths with 5 indices. Please upgrade.");const u=B.alloc(o);let h=0;const p=this.getActiveWallet();if(null===p)return e("No active wallet.");p.uid.copy(u,h),h+=32,a.varAddrPathSzAllowed&&(u.writeUInt8(r.length,h),h+=1);for(let n=0;n<5;n++)n<=r.length&&u.writeUInt32BE(r[n],h),h+=4;let f;if(!0===a.addrFlagsAllowed){const t=n.nibble.read(!0===i?1:0),e=n.nibble.read(s);f=n.byte.write(t.concat(e))}else f=s;u.writeUInt8(f,h),h++;const d=this._buildEncRequest(R.GET_ADDRESSES,u);return this._request(d,(t,r)=>{if(t)return e(t);const n=this._handleGetAddresses(r);return n.err?e(n.err):e(null,n.data)})}sign(t,e,r=null,n=null){const{currency:s}=t;let{data:i}=t;if(void 0===s||void 0===i)return e("Please provide `currency` and `data` options");if(void 0===p[s])return e("Unsupported currency");const a=b(this.fwVersion);let o,u,h;if(i={fwConstants:a,...i},null!==r&&null!==n)o=r,u=B.concat([n,o.extraDataPayloads.shift()]),h=L.EXTRA_DATA;else{if(o=p[s](i),void 0!==o.err)return e(o.err);if(o.payload.length>a.reqMaxDataSz)return e("Transaction is too large");u=o.payload,h=o.schema}const c=B.alloc(2+a.reqMaxDataSz);let l=0;const f=o.extraDataPayloads&&Number(o.extraDataPayloads.length>0);c.writeUInt8(f,l),l+=1,c.writeUInt8(h,l),l+=1;const d=this.getActiveWallet();if(null===d)return e("No active wallet.");d.uid.copy(c,l),l+=d.uid.length,u.copy(c,l);const g=this._buildEncRequest(R.SIGN_TRANSACTION,c);return this._request(g,(i,a,u)=>{if(u===x.RESP_ERR_WALLET_NOT_PRESENT)this._getActiveWallet(s=>s?e(s):this.sign(t,e,r,n));else{if(!i){if(f){const s=this._handleEncResponse(a,T.sign);return n=s.data.slice(65,73),r||(r=o),this.sign(t,e,r,n)}{const t=this._handleSign(a,s,o);return e(t.err,t.data)}}if(i)return e(i)}})}addAbiDefs(t,e,r=null){const n=t.slice(0,h);let s;t=t.slice(h);try{s=o(n)}catch(u){return e(u)}const i=B.alloc(s.length+10);i.writeUInt16LE(t.length),null!==r&&r.copy(i,2),s.copy(i,10);const a=this._buildEncRequest(R.ADD_ABI_DEFS,i);return this._request(a,(n,s,i)=>{if(i&&i!==x.RESP_SUCCESS)return e("Error making request.");if(n)return e(n);const a=this._handleEncResponse(s,T.addAbiDefs);if(r=a.data.slice(65,73),0===t.length)return e(null);this.addAbiDefs(t,e,r,t)})}addPermissionV0(t,e){const{currency:r,timeWindow:n,limit:s,decimals:i,asset:a}=t;if(!r||void 0===n||void 0===s||void 0===i||null===n||null===s||null===i)return e("currency, timeWindow, decimals, and limit are all required options.");if(0===n||0===s)return e("Time window and spending limit must be positive.");let o=r;a&&(o+="_"+a);const u=B.alloc(293);if(B.from(o).length>255)return e("Asset name too long.");B.from(o).copy(u,0);const h=_(s);if(h.length>32)return e("Limit too large.");h.copy(u,32-h.length+256),u.writeUInt32BE(n,288),u.writeUInt8(i,292);const c=this._buildEncRequest(R.ADD_PERMISSION_V0,u);return this._request(c,(r,n,s)=>{if(s===x.RESP_ERR_WALLET_NOT_PRESENT)this._getActiveWallet(r=>r?e(r):this.addPermissionV0(t,e));else{if(!r){const t=this._handleEncResponse(n,T.finalizePair);return e(t.err?t.err:null)}if(r)return e(r)}})}_getActiveWallet(t,e=!1){if(!0===e||!0!==this.hasActiveWallet()&&!0===this.isPaired){const e=B.alloc(0),r=this._buildEncRequest(R.GET_WALLETS,e);return this._request(r,(e,r)=>e?(this._resetActiveWallets(),t(e)):t(this._handleGetWallets(r)))}return t(null)}_getSharedSecret(){return B.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))}_getEphemId(){if(null===this.ephemeralPub)return null;const t=this._getSharedSecret();return this.crypto.createHash("sha256").update(t).digest().slice(0,4)}_buildEncRequest(t,e){const r=parseInt(this._getEphemId().toString("hex"),16),n=B.concat([B.from([t]),e]),s=y(n),i=B.alloc(n.length+4);n.copy(i,0),i.writeUInt32LE(s,n.length);const a=this._getSharedSecret(),o=d(i,a),u=B.alloc(I+4);return u.writeUInt32LE(r,0),o.copy(u,4),this._buildRequest(A.ENCRYPTED_REQUEST,u)}_buildRequest(t,e){let r=e&&B.isBuffer(e)?e.length+1:1;t===A.ENCRYPTED_REQUEST&&(r=1+e.length);let n=0;const s=B.alloc(r+8);n=s.writeUInt8(N,n),n=s.writeUInt8(P,n);const i=this.crypto.randomBytes(4);n=s.writeUInt32BE(parseInt("0x"+i.toString("hex")),n),n=s.writeUInt16BE(r,n),n=s.writeUInt8(t,n),r>1&&(n=e.copy(s,n));const a=y(s),o=B.alloc(s.length+4);return n=s.copy(o),o.writeUInt32BE(a,n),o}_request(t,e,r=this.retryCount){if(!this.deviceId)return e("Serial is not set. Please set it and try again.");s.post(`${this.baseUrl}/${this.deviceId}`).timeout(this.timeout).send({data:t}).then(n=>{if(!n||!n.body)return e("Invalid response: "+n);if(200!==n.body.status)return e(`Error code ${n.body.status}: ${n.body.message}`);const s=w(n.body.message);return(s.responseCode===x.RESP_ERR_DEV_BUSY||s.responseCode===x.RESP_ERR_GCE_TIMEOUT)&&r>0?setTimeout(()=>{this._request(t,e,r-1)},3e3):(s.responseCode===x.RESP_ERR_WALLET_NOT_PRESENT&&this._resetActiveWallets(),s.err?e(s.err):e(null,s.data,s.responseCode))}).catch(t=>(console.log("request err",t),e("ECONNABORTED"===t.code&&"ETIME"===t.errno?"Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.":"Failed to make request to device.")))}_handleConnect(t){let e=0;const r=t.readUInt8(e);e++;const n=t.slice(e,e+65).toString("hex");return e+=65,this.fwVersion=t.slice(e,e+4),this.ephemeralPub=m(n),r===U.PAIRED}_handleEncResponse(t,e){const r=this._getSharedSecret(),n=t.slice(0,I),s=f(n,r),i=s.slice(0,e+=65),a=parseInt("0x"+s.slice(e,e+4).toString("hex")),o=y(i);if(a!==o)return{err:`Checksum mismatch in response from Lattice (calculated ${o}, wanted ${a})`};const u=s.slice(0,65).toString("hex");try{return this.ephemeralPub=m(u),{err:null,data:s}}catch(h){return{err:"Error handling getAddresses response: "+h.toString()}}}_handlePair(t){const e=this._handleEncResponse(t,T.finalizePair);return e.err?e.err:(this.pairingSalt=null,this.isPaired=!0,null)}_handleGetAddresses(t){const e=this._handleEncResponse(t,T.getAddresses);if(null!==e.err)return e;const r=e.data;let n=65;const s=[];for(;n+4<T.getAddresses;){const t=r.slice(n,n+v);n+=v;const e=t.indexOf(0);e>0&&s.push(t.slice(0,e).toString())}return{data:s,err:null}}_handleGetWallets(t){const e=this._handleEncResponse(t,T.getWallets);if(null!==e.err)return e;const r=e.data;let n,s=65,i=!1;return n=r.slice(s,s+32),this.activeWallets.internal.uid=n,this.activeWallets.internal.capabilities=r.readUInt32BE(s+32),this.activeWallets.internal.name=r.slice(s+36,s+71),n.equals(O)||(i=!0),s+=71,n=r.slice(s,s+32),this.activeWallets.external.uid=n,this.activeWallets.external.capabilities=r.readUInt32BE(s+32),this.activeWallets.external.name=r.slice(s+36,s+71),n.equals(O)||(i=!0),!0===i?null:"No active wallet."}_handleSign(t,e,r=null){const n=this._handleEncResponse(t,T.sign);if(null!==n.err)return{err:n.err};let s=65;const o=n.data;let u;if("BTC"===e){const t=i.addressVersion[r.changeData.changeVersion],e=o.slice(s,s+20);s+=20,u=i.getBitcoinAddress(e,t)}const h={err:null,data:null};if("BTC"===e){const t=33,e=[],n=[];let a=0;for(;s<o.length&&48===o[s];)n.push(o.slice(s,s+2+o[s+1])),e.push(o.slice(a*t+825,(a+1)*t+825)),s+=74,a+=1;const c={inputs:[],outputs:[],isSegwitSpend:r.origData.isSegwit,network:r.origData.network,crypto:this.crypto};c.outputs.push({value:r.origData.value,recipient:r.origData.recipient}),r.changeData.value>0&&c.outputs.push({value:r.changeData.value,recipient:u});for(let s=0;s<n.length;s++)c.inputs.push({hash:r.origData.prevOuts[s].txHash,index:r.origData.prevOuts[s].index,sig:n[s],pubkey:e[s]});const l=i.serializeTx(c);let p=l;!0===c.isSegwitSpend&&(c.isSegwitSpend=!1,p=i.serializeTx(c));let f=this.crypto.createHash("sha256").update(B.from(p,"hex")).digest();f=this.crypto.createHash("sha256").update(f).digest().reverse().toString("hex"),h.data={tx:l,txHash:f,changeRecipient:u,sigs:n}}else if("ETH"===e){const t=g(o.slice(s,s+2+o[s+1]));s+=74;const e=o.slice(s,s+20),n=a.buildEthRawTx(r,t,e,r.useEIP155);h.data={tx:"0x"+n,txHash:"0x"+a.hashTransaction(n),sig:{v:t.v,r:t.r.toString("hex"),s:t.s.toString("hex")},signer:e}}else if("ETH_MSG"===e){const t=g(o.slice(s,s+2+o[s+1]));s+=74;const e=o.slice(s,s+20),n=a.validateEthereumMsgResponse({signer:e,sig:t},r);h.data={sig:{v:n.v,r:n.r.toString("hex"),s:n.s.toString("hex")},signer:e}}return h}_resetActiveWallets(){this.activeWallets.internal.uid=O,this.activeWallets.internal.name=null,this.activeWallets.internal.capabilities=null,this.activeWallets.external.uid=O,this.activeWallets.external.name=null,this.activeWallets.external.capabilities=null}getActiveWallet(){return O.equals(this.activeWallets.external.uid)?O.equals(this.activeWallets.internal.uid)?null:this.activeWallets.internal:this.activeWallets.external}hasActiveWallet(){return null!==this.getActiveWallet()}pubKeyBytes(t=!1){const e=this.key.getPublic().encode("hex"),r=B.from(e,"hex");if(!0===t){const t=r.slice(1,33).reverse(),e=r.slice(33,65).reverse();return B.concat([r[0],t,e])}return r}parseAbi(t,e,r=!1){switch(t){case"etherscan":return u[t](e,r);default:return{err:`No ${t} parser available.`}}}}},u0zn:function(t,e,r){const n=r("tjlA").Buffer,s=r("zNmP").keccak256,{ETH_ABI_LATTICE_FW_TYPE_MAP:i}=r("L21C");e.MAX_ABI_DEFS=2,e.buildAddAbiPayload=function(t){if(!t||!Array.isArray(t))throw new Error("Missing definitions.");if(t.length>e.MAX_ABI_DEFS)throw new Error("You may only add 2 ABI definitions per request.");const r=n.alloc(1147);let s=0;return r.writeUInt8(t.length,s),s++,t.forEach(t=>{if(!t.sig||!t.name||!t.params)throw new Error("name, sig, and params must be present for every ABI definition.");const e=n.from(t.sig,"hex");if(4!==e.length)throw new Error("Function signatures must always be four bytes.");if(e.copy(r,s),s+=e.length,n.from(t.name).length>99)throw new Error("Only function names shorter than 100 characters are supported.");n.from(t.name).slice(0,100).copy(r,s),s+=100;const i=Array.isArray(t.params)?t.params.length:0;if(r.writeUInt8(i,s),s++,i>18)throw new Error("Currently only ABI defintions with <=10 parameters are supported.");i>0?(t.params.forEach(t=>{if(!t.name||!t.latticeTypeIdx||void 0===t.isArray||void 0===t.arraySz)throw new Error("name, latticeTypeIdx, isArray, and arraySz must be defined for all ABI params.");n.from(t.name).slice(0,20).copy(r,s),s+=20}),s+=20*(18-i),t.params.forEach(t=>{r.writeUInt8(t.latticeTypeIdx,s),s++,r.writeUInt8(!0===t.isArray,s),s++,r.writeUInt32LE(t.arraySz,s),s+=4}),s+=6*(18-i)):s+=468}),r},e.getFuncSig=function(t){let e=t.name+"(";return t.inputs.forEach(t=>{if(t.type.indexOf("tuple")>-1){const r=t.type.slice(t.type.indexOf("tuple")+5);e+="(",t.components.forEach((r,n)=>{e+=`${r.type}${n===t.components.length-1?"":","}`}),e+=`)${r},`}else e+=t.type+","}),t.inputs.length>0&&(e=e.slice(0,e.length-1)),e+=")",s(e).slice(0,8)},e.abiParsers={etherscan:function(t,r=!1){const n=[];return t.forEach(t=>{if(t.name&&t.inputs&&"function"===t.type&&"view"!==t.stateMutability&&!0!==t.constant)try{const r=e.getFuncSig(t),s=function t(e,r=[],n=!1){let s=[];if(e.forEach(e=>{const a=e.type,o={isArray:!1,arraySz:0,name:e.name},u=a.indexOf("["),h=a.indexOf("]");if(u>-1&&h>-1)if(u>=h);else if(u+1===h)o.isArray=!0;else{const t=parseInt(a.slice(u,h));if(isNaN(t))return o;o.isArray=!0,o.arraySz=t}let c=u>-1?a.slice(0,u):a;if("tuple"===c){if(!0===n)throw new Error("Nested tuples are not supported");c="tuple"+e.components.length,s=t(e.components,s,!0)}if(o.latticeTypeIdx=i[c],!o.latticeTypeIdx)throw new Error("Unsupported type: "+a);r.push(o)}),r.concat(s).length>18)throw new Error("Function has too many parameters for Lattice firmware (18 max)");return r.concat(s)}(t.inputs);n.push({name:t.name,sig:r,params:s})}catch(s){if(!0!==r)throw new Error(s);console.error("Failed to load def:",t.name,s.toString())}}),n}}},vGFC:function(t,e,r){"use strict";(function(t){e.a=function(e,r,n){void 0===n&&(n=!1);for(var s=n?r.length:e.length,i=t.alloc(s),a=0;a<s;a++)i[a]=~(e[n?a%e.length:a]^r[a]);return i}}).call(this,r("tjlA").Buffer)},xKF7:function(t,e,r){const n=r("kB5k"),s=r("tjlA").Buffer,i=r("AREZ"),a=r("L21C"),o=r("wDBh"),u=r("1B/i"),h=r("zNmP").keccak256,c=r("RP9m"),l=r("IzB8");function p(t){let e=t[0];for(;t.length>0&&"0"===e.toString();)e=(t=t.slice(1))[0];return t}function f(t,e,r,n,i){try{const a=new Uint8Array(t);let o=0;const u=g(e.r,32);e.r=u;const h=g(e.s,32);e.s=h;const c=new Uint8Array(s.concat([u,h]));let p=l.ecdsaRecover(c,o,a,!1).slice(1);if(d(p)===r.toString("hex"))return e.v=y(o,i,n),e;if(o=1,p=l.ecdsaRecover(c,o,a,!1).slice(1),d(p)===r.toString("hex"))return e.v=y(o,i,n),e;throw new Error("Invalid Ethereum signature returned.")}catch(a){throw new Error(a)}}function d(t){return h(t).slice(-40)}function g(t,e){const r=s.alloc(e);return t.length<e?(t.copy(r,e-t.length),r):t.slice(-e)}function y(t,e,r=null){if(!1===e||null===r)return s.from(new n(t).plus(27).toString(16),"hex");const i=m(r);return S("0x"+new n(i.toString("hex"),16).times(2).plus(35).plus(t).toString(16))}function _(t){return/^[\x00-\x7F]+$/.test(t)}e.buildEthereumMsgRequest=function(t){if(!t.payload||!t.protocol||!t.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");if(t.signerPath.length>5||t.signerPath.length<2)throw new Error("Please provide a signer path with 2-5 indices");const e={schema:a.signingSchema.ETH_MSG,payload:null,input:t,msg:null};try{switch(t.protocol){case"signPersonal":return function(t,e){const r=e.fwConstants.varAddrPathSzAllowed;let n=0;t.payload=s.alloc(24+e.fwConstants.ethMaxMsgSz+4),t.payload.writeUInt8(a.ethMsgProtocol.SIGN_PERSONAL,0),n+=1;const i=b(e.signerPath,r);i.copy(t.payload,n),n+=i.length;let o=e.payload,u=!1;if("string"==typeof e.payload)if("0x"===e.payload.slice(0,2))o=S(e.payload),u=!1===_(s.from(e.payload.slice(2),"hex").toString());else{if(!1===function(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)<32||t.charCodeAt(e)>127)return!1;return!0}(e.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");o=s.from(e.payload)}else if("boolean"==typeof e.displayHex)u=e.displayHex;else{if(!e.payload.toString)throw new Error("Unsupported input data type");u=!1===_(e.payload.toString())}const h=v(o,e);return t.extraDataPayloads=h,t.msg=o,t.payload.writeUInt8(u,n),n+=1,t.payload.writeUInt16LE(o.length,n),n+=2,o.copy(t.payload,n),t}(e,t);case"eip712":if(!t.fwConstants.eip712Supported)throw new Error("EIP712 is not supported by your Lattice firmware version. Please upgrade.");return function(t,e){try{const r=e.fwConstants.varAddrPathSzAllowed,n=a.ethMsgProtocol.TYPED_DATA;let o=0;t.payload=s.alloc(24+e.fwConstants.ethMaxMsgSz+4),t.payload.writeUInt8(n.enumIdx,0),o+=1;const u=b(e.signerPath,r);u.copy(t.payload,o),o+=u.length;const h=JSON.parse(JSON.stringify(e.payload));if(!h.primaryType||!h.types[h.primaryType])throw new Error("primaryType must be specified and the type must be included.");if(!h.message||!h.domain)throw new Error("message and domain must be specified.");if(0>Object.keys(h.types).indexOf("EIP712Domain"))throw new Error("EIP712Domain type must be defined.");e.payload.message=T(JSON.parse(JSON.stringify(h.message)),JSON.parse(JSON.stringify(h.primaryType)),JSON.parse(JSON.stringify(h.types)),!0),e.payload.domain=T(JSON.parse(JSON.stringify(h.domain)),"EIP712Domain",JSON.parse(JSON.stringify(h.types)),!0),h.domain=T(h.domain,"EIP712Domain",h.types,!1),h.message=T(h.message,h.primaryType,h.types,!1);const c=s.from(i.encode(h)),l=v(c,e);return t.extraDataPayloads=l,t.payload.writeUInt16LE(c.length,o),o+=2,c.copy(t.payload,o),o+=c.length,t.payload=t.payload.slice(0,o),t}catch(r){return{err:"Failed to build EIP712 request: "+r.message}}}(e,t);default:throw new Error("Unsupported protocol")}}catch(r){return{err:r.toString()}}},e.validateEthereumMsgResponse=function(t,e){const{signer:r,sig:n}=t,{input:i,msg:a}=e;if("signPersonal"===i.protocol){const t=s.from("\x19Ethereum Signed Message:\n"+a.length.toString(),"utf-8");return f(s.from(h(s.concat([t,a])),"hex"),n,r,1,!1)}if("eip712"===i.protocol)return f(u.TypedDataUtils.encodeDigest(e.input.payload),n,r);throw new Error("Unsupported protocol")},e.buildEthereumTxRequest=function(t){try{let{chainId:e=1}=t;const{signerPath:r,eip155:n=null,fwConstants:i}=t,{extraDataFrameSz:o,extraDataMaxFrames:u}=i,h=o>0&&u>0,c=i.ethMaxDataSz,l=i.varAddrPathSzAllowed;if("number"!=typeof e&&!1===w(e)&&(e=E[e]),!e)throw new Error("Unsupported chain ID or name");if(!r)throw new Error("`signerPath` not provided");let p=function(t){switch(t){case 3:case 4:return!1;case 1:case 42:case 5:default:return!0}}(e);null!==n&&"boolean"==typeof n&&(p=n),t.value||(t.value=0);const f=[],d=S(t.nonce),g=S(t.gasPrice),y=S(t.gasLimit),_=S(t.to),v=S(t.value),T=S(t.data);f.push(d),f.push(g),f.push(y),f.push(_),f.push(v),f.push(T),!0===p&&(f.push(S(e)),f.push(S(null)),f.push(S(null)));const A=s.alloc(c+122);let R,x=0;A.writeUInt8(Number(p),x),x++;let P=0;if(!0===function(t){const e=m(t);return 1!==e.length||255===e.readUInt8(0)}(e)){if(R=m(e),P=R.length,P>a.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");A.writeUInt8(a.HANDLE_LARGER_CHAIN_ID,x),x++}else{if(R=S(e),1!==R.length)throw new Error("Error parsing chainID");R.copy(A,x),x+=R.length}const N=b(r,l);if(N.copy(A,x),x+=N.length,d.length>4)throw new Error("Nonce too large");if(d.copy(A,x+(4-d.length)),x+=4,g.length>8)throw new Error("Gas price too large");if(g.copy(A,x+(8-g.length)),x+=8,y.length>4)throw new Error("Gas limit too large");if(y.copy(A,x+(4-y.length)),x+=4,20!==_.length)throw new Error("Invalid `to` address");if(_.copy(A,x),x+=20,v.length>32)throw new Error("Value too large");v.copy(A,x+(32-v.length)),x+=32;const U=[];if(T&&T.length>c){const t=P>0?P+1:0,e=T.length+t,r=c+u*o;if(!h||h&&e>r)throw new Error(`Data field too large (got ${T.length}; must be <=${r-t} bytes)`);const n=s.alloc(T.length+t);t>0?(n.writeUInt8(P,0),R.copy(n,1),T.copy(n,t)):T.copy(n,0),I(n.slice(c),o).forEach(t=>{const e=s.alloc(4);e.writeUInt32LE(t.length),U.push(s.concat([e,t]))})}return A.writeUInt16BE(T.length,x),x+=2,P>0&&(A.writeUInt8(P,x),x++,R.copy(A,x),x+=P),T.slice(0,c).copy(A,x),x+=c,{rawTx:f,payload:A.slice(0,x),extraDataPayloads:U,schema:a.signingSchema.ETH_TRANSFER,chainId:e,useEIP155:p,signerPath:r}}catch(e){return{err:e.message}}},e.buildEthRawTx=function(t,e,r,n=!0){const i=c.encode(t.rawTx),a=f(s.from(h(i),"hex"),e,r,t.chainId,n),o=t.rawTx.slice(0,6);return o.push(a.v),o.push(p(a.r)),o.push(p(a.s)),c.encode(o).toString("hex")},e.hashTransaction=function(t){return h(s.from(t,"hex"))};const E={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function m(t){let e,r;if(e=!0===w(t)?S(t):S("0x"+new n(t).toString(16)),e.length>8)throw new Error("ChainID provided is too large.");return e.length<=2||4===e.length||8===e.length?e:(3===e.length?(r=s.alloc(4),r.writeUInt32BE(t)):e.length<=8&&(r=s.alloc(8),e.copy(r,8-e.length)),r)}function w(t){if("string"!=typeof t)return!1;if("0x"!==t.slice(0,2))return!1;try{return!1===new n(t,16).isNaN()}catch(e){return!1}}function S(t){try{return null===t||0===t?s.alloc(0):((t="number"==typeof t||function(t){const e=new n(t).toString().split(".").join(""),r=new String(t);return e.slice(0,8)===r.slice(0,8)}(t)?""+new n(t).toString(16):"string"==typeof t&&"0x"===t.slice(0,2)?t.slice(2):t.toString("hex")).length%2>0&&(t="0"+t),"00"===t?s.alloc(0):s.from(t,"hex"))}catch(e){throw new Error(`Cannot convert ${t.toString()} to hex buffer (${e.toString()})`)}}function b(t,e){const r=s.alloc(24);let n=0;if(e&&t.length>5)throw new Error("Signer path must be <=5 indices.");if(!e&&5!==t.length)throw new Error("Your Lattice firmware only supports 5-index derivation paths. Please upgrade.");r.writeUInt32LE(t.length,n),n+=4;for(let s=0;s<5;s++)r.writeUInt32LE(s<t.length?t[s]:0,n),n+=4;return r}function v(t,e){const{ethMaxMsgSz:r,extraDataFrameSz:n,extraDataMaxFrames:i}=e.fwConstants,a=r,o=n>0&&i>0,u=[];if(t.length>a){const e=a+i*n;if(!o)throw new Error(`Your message is ${t.length} bytes, but can only be a maximum of ${a}`);if(o&&t.length>e)throw new Error(`Your message is ${t.length} bytes, but can only be a maximum of ${e}`);I(t.slice(a),n).forEach(t=>{const e=s.alloc(4);e.writeUInt32LE(t.length),u.push(s.concat([e,t]))})}return u}function I(t,e){const r=[],n=Math.ceil(t.length/e);let s=0;for(let i=0;i<n;i++)r.push(t.slice(s,s+e)),s+=e;return r}function T(t,e,r,n=!1){try{r[e].forEach(e=>{const a=Object.keys(r).indexOf(e.type)>-1;t[e.name]=!0===a?T(t[e.name],e.type,r,n):function(t,e,r=!1){if("bytes"===e){if(0===(t=S(t)).length)throw new Error('"bytes" type must contain at least one byte in value')}else if("bytes"===e.slice(0,5)){const r=parseInt(e.slice(5));if((t=S(t)).length!==r)throw new Error(`Expected ${e} type, but got ${t.length} bytes`)}else if("address"===e){if(0===(t=S(t)).length&&(t=s.alloc(20)),20!==t.length)throw new Error(`Address type must be 20 bytes, but got ${t.length} bytes`);!0===r&&(t="0x"+t.toString("hex"))}else if("uint8"===e||"uint16"===e||"uint32"===e||"uint64"===e)t=parseInt(S(t).toString("hex"),16);else if("uint256"===e){let e=S(t);0===e.length&&(e=s.from("00","hex")),t=!0===r?o.BigNumber.from("0x"+e.toString("hex")):(new i.Encoder).semanticTypes[1][0](e.toString("hex"),16)}else"bool"===e&&(t=!0===t?1:0);return t}(t[e.name],e.type,n)})}catch(a){throw new Error(a.message)}return t}e.chainIds=E,e.ensureHexBuffer=S}}]);